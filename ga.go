// An implementation of Conway's Game of Life.
// See reverse-gol.go for build/run

package main

import (
	"math/rand"
	"fmt"
	"runtime"
	"time"
)

type Individual struct {
	start *Board_BoolPacked
	diff  *Board_BoolPacked
	fitness int  // higher is better, no particular scale
}

/*
func IndividualMutationGenerator(amount int) func f(i *Individual) *Individual{
	return func(i *Individual) *Individual{
		
	}
}
*/

type Population struct {
	individual []*Individual
	target *Board_BoolPacked
	
	pressure_pct int
	
	mutation_pct int // (0..100)
	mutation_radius int
	mutation_loop_pct int

	crossover_pct int // (0..100)
	
	transition_collection *TransitionCollectionList
}

func NewPopulation(size int, radius int, target *Board_BoolPacked, tc *TransitionCollectionList) *Population {
	//fmt.Printf("NewPopulation(size=%d)\n", size)
	ind := make([]*Individual, size)
	for i:=0; i<size; i++ {
		ind[i] = &Individual{ 
			                  start:NewBoard_BoolPacked(board_width, board_height), 
			                  diff: NewBoard_BoolPacked(board_width, board_height), 
		                      fitness:0,
		                    }
	}
	//fmt.Printf("NewPopulation(size=%d) inited\n", size)
	return &Population{
		individual:ind,
		target:target,
		transition_collection:tc,
		
		pressure_pct:1*90+0*100,  // pressure_pct is in (50..100) = Prob(Chose better of two random individuals)
		
		mutation_pct:1*50+0*100,
		mutation_loop_pct:70,
		mutation_radius:radius,
		
		crossover_pct:30*1,
	}
}

func (p *Population) OrderIndividualsBasedOnFitness(i_1, i_2 *Individual) (*Individual,*Individual) {  
/*  This is potentially too-clever-by-half
	if i_1.fitness == i_2.fitness {
		// Secondary pressure to minimize count of on cells in starting board
		
		count_on_1 := i_1.start.CompareTo(board_empty, nil)
		count_on_2 := i_2.start.CompareTo(board_empty, nil)
		
		if count_on_1 > count_on_2 {
			i_1,i_2 = i_2,i_1 // Switch them so that i_1 is the fitter (lower is better for initial positions) of the two
		}
	} else 
*/	
	if i_1.fitness < i_2.fitness {
		i_1,i_2 = i_2,i_1 // Switch them so that i_1 is the fitter (higher is better) of the two
	}
	return i_1, i_2
}

func (p *Population) PickIndividualWithPressure() *Individual {  
	// Pick two individuals at random from population
	i_1_pos := rand.Intn(len(p.individual))
	i_1 := p.individual[i_1_pos]
	
	i_2_pos := rand.Intn(len(p.individual))
	i_2 := p.individual[i_2_pos]
	
	i_1, i_2 = p.OrderIndividualsBasedOnFitness(i_1, i_2)
	
	// if pct< a threshold, pick the better one
	i_chosen := i_1
	if rand.Intn(100) > p.pressure_pct { // i.e. only sometimes do the opposite
		i_chosen = i_2
	}
	//fmt.Printf("Individuals {%d:%d} Fitnesses : {%d:%d} -> %d\n", i_1_pos, i_2_pos, i_1.fitness, i_2.fitness, i_chosen.fitness)
	
	return i_chosen
}

func (pop *Population) BestIndividual() *Individual {
	i_best := pop.individual[0]
	for _,i := range pop.individual {
		i_best,_ = pop.OrderIndividualsBasedOnFitness(i_best, i)
	}
	return i_best
}

func (pop *Population) GenerationAfter(prev *Population) {
	// Fill in every slot
	for counter, individual := range pop.individual {
		if counter==0 { // Reserve position 0 for a copy of the previous generation's best individual
			best_individual := prev.BestIndividual()
			individual.start.CopyFrom(best_individual.start)
			individual.fitness = best_individual.fitness
			continue
		}
		
		choser := rand.Intn(100)
		if 0<=choser && choser < pop.crossover_pct { 
			// Do a 'crossover copy' from two individuals in previous population to this one
			parent_1 := prev.PickIndividualWithPressure()
			parent_2 := prev.PickIndividualWithPressure()
			individual.start.CrossoverFrom(parent_1.start, parent_2.start)
		} else { // Do a simple copy, with the possibility of mutation (below)
			i_chosen := prev.PickIndividualWithPressure()
			individual.start.CopyFrom(i_chosen.start)
			if pop.crossover_pct<=choser && choser < (pop.crossover_pct + pop.mutation_pct) {
				//individual.start.MutateRadiusBits(pop.mutation_loop_pct, pop.mutation_radius) // % do additional mutation, radius of action
				
				x,y := -1,-1
				if rand.Intn(100)>20 {
					// For this individual, pick a position in the diff
					x,y = i_chosen.diff.RandomBitPosition()
				} else {
					// For this individual, pick a position in the target, just for a change
					x,y = pop.target.RandomBitPosition()
				}
				
				if x>=0 && y>=0 {
					// Offset by a little bit...
					if true {
						//fmt.Printf("target_error@(%2d,%2d):\n", x,y)
						x = CoordWithinRadius(x, i_chosen.diff.w, pop.mutation_radius/2+1)
						y = CoordWithinRadius(y, i_chosen.diff.h, pop.mutation_radius/2+1)
					}
				} else {
					// There are no errors...  So we don't have a basis for complaining, really
					// So let's create a mask based on bits from the end (for variety)
					
					if true {
						//fmt.Printf("No errors to mutate around : Try using the target instead of the diff\n")
						//fmt.Println(i_chosen.start) // Check
						x,y = pop.target.RandomBitPosition()
						//fmt.Println("*** Isn't the end image DEFINED to be non-blank? ***")
					}
					
					if false {
						//fmt.Printf("No errors to mutate around : Try zeroing out bits in the start\n")
						individual.start.MutateMask(individual.start, pop.mutation_loop_pct, 0) // % do additional mutation, radius of action
						x,y = -1,-1 // Don't do the overlay thing
					}
				}
				if x>=0 && y>=0 {
					end := pop.target.MakePatch(x,y)
					//fmt.Printf("Examining patch(%8d) from target @(%2d,%2d):\n", int(end), x,y)
					//fmt.Print(end)
					
					start_random := pop.transition_collection.GetRandomEntry_OrientationCompensated(end)
					if start_random>=0 { // Yes - we have an overlay to try...
						//fmt.Print("Suggested Start :\n")
						//fmt.Print(start_random)
						individual.start.OverlayPatch(x,y, start_random)
					} else {
						//fmt.Printf("Did not find known start patch for :\n")
						//fmt.Print(end)
						
						// Use the diff mask calculated for the chosen individual instead (i.e. DO SOMETHING)
						// individual.start.MutateMask(i_chosen.diff, pop.mutation_loop_pct, pop.mutation_radius)
						
						// Use the chosen individual bits as a bit mask instead (i.e. DO SOMETHING)
						
						if false {
							//fmt.Printf("Introducing random noise\n")
							individual.start.MutateMask(individual.start, pop.mutation_loop_pct, pop.mutation_radius)
						}
						
						if false {
							//fmt.Printf("Introducing random zeroing\n")
							individual.start.MutateMask(individual.start, pop.mutation_loop_pct, 0) // % do additional mutation, radius of action
						}
					}
				}
				
			}
		}

		individual.fitness = 0
	}
}

type IndividualResult struct {
	individual *Individual
	mismatch_from_true_start_initial, mismatch_from_true_start_final int
	mismatch_from_true_end_initial, mismatch_from_true_end_final int
	true_start_1s, true_end_1s int
	iter int
}

func create_solution(problem LifeProblem, lps *LifeProblemSet) *IndividualResult {
	// Create a population of potential boards
	pop_size := 1000
	pop := NewPopulation(pop_size, problem.steps, problem.end, &lps.transition_collection[problem.steps])
	for i:=0; i<pop_size; i++ {
		// Create a candidate starting point
		// NB:  We can only work from the problem.end
		pop.individual[i].start.CopyFrom(problem.end)
	}
	
	p_temp := NewPopulation(pop_size, problem.steps, problem.end, &lps.transition_collection[problem.steps])

	l := NewBoardIterator(board_width, board_height)
	
	var best_individual *Individual
	best_individual_start := NewBoard_BoolPacked(board_width, board_height)
	
	mismatch_from_true_start_initial, mismatch_from_true_start_latest, true_start_1s := -999,-999,-999
	mismatch_from_true_end_initial, mismatch_from_true_end_latest, true_end_1s := 0,0,0
	
	if lps.is_training {
		true_start_1s = problem.start.CompareTo(board_empty, nil)
	}
	true_end_1s = problem.end.CompareTo(board_empty, nil)
	
	checkpoints:=100
	checkpoints=20 // TODO:: REMOVE THIS
	
	iter_max  := 2000
	iter_last := 0
	for iter:=0; iter<iter_max; iter++ {
		// Evaluate fitness of every individual in pop
		for i, individual := range pop.individual {
			l.current.CopyFrom(individual.start)
			
			mismatch_from_true_start:=-999 // NB: Don't use this in fitness calculations!!
			if lps.is_training {
				diff     := NewBoard_BoolPacked(board_width, board_height)
				mismatch_from_true_start = l.current.CompareTo(problem.start, diff)
				
				if i==0 { // NB: Best individual is always in [0] (forced there in GenerationAfter)
					mismatch_from_true_start_latest  = mismatch_from_true_start
					if iter == 0 { 
						mismatch_from_true_start_initial  = mismatch_from_true_start
					}
				}
			}
			
			l.Iterate(problem.steps)
			
			// This is 'allowed' since we know the end result, and can store the diff
			mismatch_from_true_end := l.current.CompareTo(problem.end, individual.diff)
			
			if i==0 { // NB: Best individual is always in [0] (forced there in GenerationAfter)
				mismatch_from_true_end_latest  = mismatch_from_true_end
				if iter == 0 { 
					mismatch_from_true_end_initial  = mismatch_from_true_end
				}
			}
			
			// This is a lower factor pressure, but good to have too
			count_on := individual.start.CompareTo(board_empty, nil)
			
			individual.fitness = -mismatch_from_true_end  -count_on*0
			//individual.fitness = -mismatch_from_true_end*4 -count_on*1
			//individual.fitness = -mismatch_from_true_end*problem.steps -count_on*1
			
			if i<3 && (iter % checkpoints == 0) {
				fmt.Printf("%4d.%3d : Mismatch vs true {start,end} = {%3d,%3d}\n", iter, i, mismatch_from_true_start, mismatch_from_true_end) // , individual.start
			}
			
			iter_last=iter
		}
		
		best_individual = pop.BestIndividual()
		//fmt.Printf("%4d.best: Mismatch vs true {start,end} = {???,%3d}\n", iter, best_individual.fitness)
		//fmt.Print(best_individual.start)

		if iter>0 && (iter % checkpoints == 0) {
			difference_over_100_generations := best_individual.start.CompareTo(best_individual_start, nil)
			if difference_over_100_generations == 0 {
				// Our best candidate hasn't improved in 100 generations
				// So our job is done!
				iter = iter_max
				break
			}
		}
		
		if iter % checkpoints == 0 {
			best_individual_start.CopyFrom(best_individual.start)
		}
		
		p_temp.GenerationAfter(pop)
		pop, p_temp = p_temp, pop // Switcheroo to advance to next population
	}
	
	return &IndividualResult{
		individual : best_individual, 
		
		mismatch_from_true_start_initial : mismatch_from_true_start_initial, 
		mismatch_from_true_start_final   : mismatch_from_true_start_latest,
		mismatch_from_true_end_initial : mismatch_from_true_end_initial, 
		mismatch_from_true_end_final   : mismatch_from_true_end_latest,
		
		true_start_1s:true_start_1s,
		true_end_1s:true_end_1s,
		
		iter:iter_last,
	}
}

// http://devcry.heiho.net/2012/07/golang-masterworker-in-go.html
type Work struct {
	id int
	i,n int
	is_training bool
	steps int
	lps *LifeProblemSet
	
	number_of_times_to_run_this_id int
}

func problem_worker_for_queue(worker_id int, queue chan *Work) {
	var wp *Work
	for {
		// get work item (pointer) from the queue
		wp = <-queue
		if wp == nil {
			break
		}
		id := wp.id
		fmt.Printf("worker #%d: received work :: %5d\n", worker_id, id)
	
		/*  HMM : For the concurrent code, should be creating a Source for each worker 
		 *       - so that they aren't reseeding each other non-deterministically...
		 * 
		 * ***TODO***
		 *func NewSource
		 * func NewSource(seed int64) Source
		 * NewSource returns a new pseudo-random Source seeded with the given value. 
		*/
		
		for i:=0; i< wp.number_of_times_to_run_this_id; i++ {
			seed := get_unprocessed_seed_from_db(id, wp.is_training)
			
			fmt.Printf("(%5d/%5d) Running problem[%d].steps=%d (seed=%d)\n", wp.i, wp.n, id, wp.steps, seed)
			rand.Seed(int64(seed))
			individual_result := create_solution(wp.lps.problem[id], wp.lps)
			save_solution_to_db(id, wp.steps, seed, individual_result, wp.is_training)
		}
	}
}

func pick_problems_from_db_and_solve_them(steps int, problem_count_requested int, is_training bool) {  
	problem_list := list_of_interesting_problems_from_db(steps, problem_count_requested, is_training)
	
	//problem_list := []int{50,54}
	solve_list_of_problems_and_write_to_db(steps, problem_list, is_training)
}

func pick_problems_from_list_and_solve_them(steps int, list_position int) {
	s := make([][]int, 5+1)
	s[1]=[]int{117,144,158,287,289,305,409,427,528,609,682,824,827,873,917,938,987,1005,1007,1061,1166,1169,1177,1181,1197,1220,1285,1306,1366,1402,1438,1454,1586,1589,1719,1838,1942,1946,1962,2040,2062,2069,2106,2176,2194,2215,2225,2231,2239,2260,2277,2442,2506,2555,2558,2595,2679,2710,2723,2733,2840,2921,2949,2951,3036,3072,3145,3170,3197,3318,3356,3424,3430,3466,3488,3542,3596,3740,3790,3802,3814,3968,4004,4132,4165,4265,4329,4427,4541,4615,4698,4715,4790,4836,4839,4841,4845,4878,4920,4953,5022,5031,5056,5243,5299,5371,5372,5386,5423,5448,5454,5508,5514,5526,5537,5698,5703,5709,5791,5806,5822,5827,5888,6073,6245,6308,6370,6374,6456,6463,6484,6490,6509,6542,6567,6589,6661,6679,6790,6809,6838,6858,7068,7069,7074,7160,7272,7289,7304,7486,7496,7502,7520,7551,7555,7651,7686,7727,7747,7804,7838,7883,7917,7947,7950,8027,8225,8247,8263,8290,8318,8323,8337,8458,8482,8509,8577,8648,8649,8681,8721,8731,8770,8806,8898,8955,8987,9055,9082,9151,9223,9238,9323,9350,9353,9364,9377,9540,9611,9625,9676,9752,9822,9847,9952,10052,10082,10092,10111,10206,10225,10390,10393,10452,10476,10477,10495,10541,10577,10635,10685,10716,10755,10790,10920,11268,11287,11292,11303,11314,11506,11522,11527,11564,11607,11740,11826,11892,11969,11980,12011,12063,12077,12087,12244,12278,12307,12507,12523,12544,12622,12625,12723,12756,12853,13018,13183,13196,13197,13229,13231,13436,13448,13616,13629,13632,13684,13694,13705,13711,13717,13747,13749,13802,13814,13862,14090,14092,14152,14322,14421,14430,14432,14446,14458,14467,14504,14515,14631,14728,14786,14787,14826,14903,14909,14914,14935,14994,15078,15089,15106,15109,15226,15258,15274,15366,15391,15393,15394,15415,15458,15525,15590,15606,15668,15716,15751,15762,15799,15850,15982,16198,16222,16385,16457,16483,16487,16564,16613,16634,16675,16697,16707,16852,16963,16997,17001,17083,17084,17105,17192,17248,17291,17400,17556,17706,17744,17805,17817,17833,17939,18049,18087,18104,18107,18111,18307,18369,18380,18416,18417,18477,18592,18596,18684,18706,18715,18846,18857,18903,19029,19059,19110,19209,19214,19277,19433,19538,19544,19652,19812,19829,19917,19972,19973,20028,20163,20180,20194,20271,20276,20287,20320,20412,20430,20496,20535,20665,20747,20806,20811,20835,20853,20874,20878,20911,20962,21004,21118,21130,21133,21135,21237,21251,21269,21272,21284,21357,21483,21773,21785,21808,21848,21881,21947,21973,21990,22047,22058,22110,22269,22291,22310,22366,22402,22411,22436,22528,22533,22685,22689,22695,22749,22756,22782,22884,22905,22928,22933,22962,23158,23159,23195,23293,23413,23453,23598,23672,23675,23694,23853,23899,23909,24126,24152,24177,24371,24429,24485,24509,24532,24559,24574,24576,24583,24593,24620,24916,25053,25248,25266,25337,25393,25420,25441,25464,25504,25520,25549,25632,25633,25641,25735,25748,25774,25823,25857,25858,25865,25927,25945,25962,26057,26062,26072,26112,26130,26286,26472,26597,26739,26795,26855,26869,26985,27005,27163,27201,27435,27492,27591,27627,27710,27731,27821,27829,27904,27914,28068,28107,28201,28460,28511,28549,28594,28683,28712,28821,28870,29014,29024,29074,29136,29161,29232,29238,29241,29245,29334,29403,29430,29616,29628,29665,29696,29722,29752,29899,29968,29983,30021,30128,30130,30250,30252,30288,30359,30479,30542,30610,30685,30699,30772,30820,30850,30968,30986,31024,31062,31155,31227,31242,31288,31305,31347,31350,31373,31378,31512,31544,31654,31683,31711,31791,31805,31896,31934,32054,32146,32217,32284,32349,32350,32402,32535,32595,32615,32657,32664,32829,32843,32857,33002,33097,33218,33237,33244,33327,33366,33377,33565,33573,33729,33873,33918,33993,34037,34061,34275,34331,34417,34439,34513,34823,34824,34832,34955,34978,35099,35205,35294,35366,35375,35505,35550,35596,35640,35692,35754,35810,35855,35997,36077,36218,36292,36343,36378,36492,36504,36597,36660,36669,36677,36717,36723,36937,37038,37045,37079,37083,37136,37184,37195,37311,37321,37357,37394,37445,37499,37528,37545,37606,37765,37844,37900,37934,37979,38010,38119,38251,38284,38440,38458,38576,38611,38629,38700,38770,38864,38868,39002,39121,39181,39216,39252,39291,39307,39355,39443,39465,39548,39648,39668,39726,39888,40015,40037,40059,40109,40160,40287,40377,40417,40421,40465,40524,40557,40561,40586,40680,40720,40784,40997,41015,41063,41093,41156,41157,41245,41300,41387,41403,41409,41495,41532,41608,41699,41729,41822,41889,41926,41992,42115,42208,42338,42345,42437,42463,42465,42593,42652,42705,42710,42762,42797,42897,42935,43039,43080,43109,43234,43255,43262,43300,43326,43400,43457,43469,43503,43504,43537,43547,43552,43685,43722,43731,43739,43818,43954,44024,44065,44119,44132,44174,44236,44282,44290,44293,44337,44352,44393,44430,44437,44469,44478,44499,44500,44524,44538,44614,44717,44725,44742,45007,45012,45078,45195,45212,45226,45235,45355,45418,45419,45450,45462,45466,45508,45543,45753,45759,45781,45785,45865,45979,45986,46004,46089,46333,46432,46513,46534,46574,46611,46629,46658,46667,46880,46905,47045,47101,47154,47210,47263,47304,47524,47619,47819,47863,47915,47945,47993,48032,48045,48097,48114,48205,48254,48293,48421,48700,48760,48782,48959,48995,49111,49112,49141,49165,49193,49211,49273,49407,49489,49491,49550,49554,49588,49795,49909,49929,49944,49959,177,272,332,412,778,814,840,859,863,1029,1082,1174,1178,1262,1406,1411,1461,1539,1543,1570,1580,1593,1707,1720,1733,1809,1815,1864,1961,2037,2108,2126,2143,2210,2322,2395,2457,2475,2486,2499,2538,2614,2621,2676,2740,2818,2865,2904,2952,3015,3176,3186,3192,3229,3300,3447,3516,3559,3642,3657,3699,3709,3805,4082,4156,4172,4203,4223,4242,4317,4460,4513,4622,4638,4643,4678,4739,4776,4840,4870,4948,4974,4990,5050,5169,5263,5602,5716,5736,5805,5950,5969,5982,5990,6034,6046,6087,6109,6129,6149,6161,6175,6186,6286,6623,6716,6820,7004,7109,7127,7131,7152,7284,7407,7424,7477,7528,7543,7546,7573,7640,7670,7674,7675,7908,7951,7955,7995,8062,8075,8141,8219,8378,8425,8499,8643,8873,9004,9206,9267,9370,9454,9513,9521,9568,9585,9603,9657,9672,9713,9718,9920,10004,10030,10125,10248,10256,10354,10546,10569,10574,10592,10640,10847,10911,10965,10985,10994,11107,11183,11383,11402,11417,11471,11530,11566,11654,11678,11697,11782,11866,11955,12005,12083,12199,12257,12346,12370,12509,12649,12693,12724,12733,12770,12793,12822,12843,12866,12915,13051,13097,13155,13175,13369,13378,13637,13681,13890,13999,14037,14052,14203,14207,14303,14351,14426,14471,14550,14576,14778,14858,15001,15030,15250,15254,15456,15536,15555,15583,15611,15655,15667,15776,15781,15802,15852,15977,16016,16215,16326,16364,16416,16428,16558,16759,16858,16971,17057,17081,17085,17187,17273,17375,17377,17417,17524,17573,17803,17951,18163,18208,18352,18366,18374,18495,18696,18931,19026,19199,19325,19381,19462,19515,19553,19649,19716,19717,19755,19961,19981,20104,20140,20198,20257,20259,20326,20380,20403,20488,20579,20611,20617,20680,20731,20740,20990,21173,21184,21202,21282,21330,21658,21696,22017,22048,22158,22320,22385,22391,22510,22539,22565,22581,22619,22728,22912,22922,23093,23178,23233,23352,23353,23376,23592,23665,23670,23703,23708,23737,23743,23848,24003,24150,24174,24185,24219,24282,24318,24327,24478,24572,24589,24596,24621,24638,24794,24809,24846,24922,25135,25189,25238,25241,25536,25627,25669,25808,25826,25859,25880,25928,25933,26142,26201,26351,26358,26371,26481,26595,26601,26635,26887,27021,27036,27123,27213,27235,27422,27494,27514,27607,27633,27708,28134,28217,28432,28512,28553,28734,28748,28751,28854,28937,29069,29084,29151,29195,29200,29374,29384,29406,29452,29517,29558,29700,29726,29884,29962,30036,30053,30133,30199,30202,30283,30296,30448,30541,30690,30720,30724,30787,30910,30917,30934,30969,30999,31015,31060,31072,31075,31114,31161,31434,31469,31616,31662,31724,31928,31992,32039,32077,32079,32258,32314,32317,32332,32347,32432,32437,32550,32633,32716,32830,32849,32863,33032,33052,33074,33104,33126,33196,33310,33336,33376,33458,33598,33645,33686,33708,33863,33882,34023,34233,34285,34291,34316,34326,34329,34368,34667,34714,34792,34867,34950,35036,35269,35364,35493,35554,35690,35700,35713,35762,35770,35795,35846,35857,35861,35977,36022,36058,36172,36192,36247,36356,36461,36515,36522,36539,36603,36701,36740,36854,36962,36983,37032,37228,37230,37385,37510,37629,37730,37753,37779,37826,37833,37899,37968,37981,38267,38541,38580,38633,38780,38835,39024,39057,39065,39101,39140,39203,39276,39386,39430,39439,39612,39644,39705,39715,39730,39742,39859,39895,39947,40136,40158,40429,40435,40467,40490,40499,40566,40666,40704,40755,40793,40860,40867,40882,41044,41104,41105,41115,41138,41235,41410,41561,41652,41795,41825,41887,41895,41901,41952,42032,42044,42108,42118,42169,42256,42317,42422,42431,42453,42474,42511,42531,42537,42541,42651,42765,42782,42872,42994,43221,43348,43411,43460,43510,43517,44084,44092,44158,44355,44405,44528,44561,44701,44748,44890,44900,45003,45085,45131,45185,45223,45520,45586,45690,45816,45899,45923,46162,46361,46584,46585,46592,46640,46643,46694,46850,46855,46865,46942,47110,47184,47256,47277,47290,47327,47371,47445,47485,47550,47660,47716,47822,47906,48017,48092,48143,48240,48275,48324,48440,48485,48494,48502,48518,48648,48736,48910,48913,49131,49217,49272,49336,49691,49722,49844,49913,49952,35,73,112,209,363,389,408,470,535,878,928,1002,1556,1773,1881,1982,2234,2397,2484,2547,2556,2565,2648,2719,2794,2814,2856,2873,2924,3501,3523,3553,3554,3575,3731,3732,3830,3855,3865,4119,4123,4230,4448,4487,4617,4753,4849,5130,5138,5141,5218,5227,5285,5326,5366,5383,5465,5467,5557,5648,5704,5712,5968,6085,6135,6235,6260,6377,6449,6724,6752,6757,6886,6926,6934,6983,7034,7198,7244,7316,7398,7449,7485,7876,7936,7969,8171,8193,8260,8325,8402,8404,8410,8470,8504,8815,9005,9025,9051,9097,9111,9469,9515,9596,9789,9818,9833,9860,9950,9994,10091,10128,10143,10150,10178,10277,10353,10359,10505,10565,10653,10714,10845,11075,11149,11167,11533,11707,11741,11753,11822,11931,12051,12363,12414,12521,13041,13095,13116,13135,13281,13302,13347,13491,13664,13795,13863,13966,14082,14117,14359,14644,14724,14796,15029,15111,15269,15297,15314,15372,15497,15516,15632,15747,15843,15924,16180,16187,16238,16295,16376,16454,17018,17035,17237,17332,17399,17473,17490,17588,17595,17645,17859,17947,17976,17986,18042,18181,18229,18253,18274,18288,18304,18752,18886,18906,18984,19009,19011,19038,19237,19463,19476,19787,19966,20360,20369,20386,20400,20437,20602,20629,20839,21073,21294,21452,21843,21864,21867,21981,22090,22185,22423,22534,22610,22628,22705,22713,22943,23082,23150,23459,23565,23608,23617,23738,23766,23797,23915,23916,23917,23944,23984,24154,24384,24502,24512,24581,24602,24947,25021,25064,25212,25228,25230,25761,25778,25950,25951,25972,26008,26030,26065,26132,26148,26155,26189,26199,26363,26368,26499,26523,26530,26564,26649,26667,26727,26745,26834,26927,26992,27028,27103,27445,27696,27758,27760,27827,27864,27960,27978,28050,28216,28499,28547,28556,28687,28716,28849,28910,29118,29183,29189,29309,29474,29548,29666,29708,29714,29767,29791,29818,29837,29876,29895,30022,30072,30076,30104,30166,30193,30233,30332,30368,30596,30717,30722,30775,30819,30886,30904,30954,31098,31195,31248,31351,31358,31369,31496,31559,31567,31604,31625,31644,31822,31845,31943,31951,31988,32125,32137,32427,32446,32525,32671,32864,32892,32912,32985,33103,33166,33340,33448,33608,33659,33762,33769,33848,34096,34348,34353,34366,34414,34492,34658,34787,34944,35154,35156,35195,35273,35338,35545,35578,35675,35751,35811,35882,35908,35958,35996,36023,36133,36358,36556,36733,36836,36839,36951,37025,37266,37287,37300,37504,37549,37570,37694,37718,37740,37893,37953,37996,38025,38387,38437,38466,38478,38504,38578,38740,38930,38981,39243,39255,39406,39429,39522,39560,39777,39867,40036,40162,40446,40491,40653,40796,40799,40812,40828,41122,41269,41290,41356,41453,41489,41494,41511,41632,41637,41640,41650,41670,41910,41938,41972,42033,42166,42414,42534,42557,43157,43242,43456,43491,43499,43527,43544,43549,43653,43677,43691,43762,43767,43981,44004,44039,44083,44086,44427,44439,44504,44622,44624,44640,44761,44830,44967,45180,45290,45312,45328,45463,45487,45488,45548,45802,46024,46161,46206,46237,46319,46634,46808,46809,46813,47062,47118,47165,47170,47295,47356,47734,47891,47897,48001,48074,48102,48158,48329,48339,48413,48599,48834,48846,48936,48972,49201,49207,49271,49473,49498,49519,49527,49558,49610,49713,49717,49787,49919,45,245,355,453,474,478,485,621,697,702,923,1063,1069,1073,1108,1129,1163,1339,1369,1380,1392,1561,1612,1628,1751,2023,2161,2440,2747,2875,3085,3087,3190,3426,3503,3546,3861,4018,4045,4103,4352,4355,4358,4369,4573,4783,5238,5482,5682,5748,5767,5832,5973,5991,6244,6421,6971,7103,7133,7134,7201,7203,7350,7361,7540,7715,7835,7914,7974,7986,8076,8133,8229,8715,8795,9008,9036,9560,9757,9958,10015,10060,10103,10110,10242,10644,10652,10658,10782,10894,10949,10960,11101,11389,11484,11500,11597,11897,12120,12175,12181,12202,12330,12371,12543,12732,12885,12918,13013,13023,13081,13093,13184,13213,13223,13503,13710,14201,14482,14663,14759,14809,14821,15278,15434,15478,16175,16190,16216,16510,16584,16760,16863,17306,17360,17398,17441,17475,17540,17648,17985,17999,18348,18476,18562,18681,18964,19019,19166,19417,19448,19572,19612,19798,19896,19951,20077,20188,20220,20570,20582,20749,20761,20775,20826,20942,21007,21035,21059,21102,21234,21289,21584,21593,22079,22280,22301,22396,22509,22531,22720,23167,23456,23667,23687,23697,23761,23790,23800,23806,23893,23924,24016,24027,24053,24359,24426,24679,24897,24970,24979,25319,25414,25585,25639,25658,26223,26268,26296,26534,26544,26548,27186,27688,27953,27992,28051,28242,28325,28357,28358,28531,28657,28678,28790,29026,29064,29150,29362,29368,29415,29444,29491,29580,29668,29780,30083,30418,30558,30624,30650,31030,31249,31325,31549,31664,31713,31762,31785,31907,31919,31921,32101,32226,32586,32765,32781,33333,33359,33433,33486,33795,33821,33856,34032,34071,34117,34530,34848,34864,34887,35217,35266,35415,35419,35522,35537,35614,35623,35638,35647,35839,35891,35900,36019,36190,36226,36330,36352,36392,36722,36725,36946,37074,37164,37222,37410,37478,37564,37790,37845,37965,38302,38713,38802,38823,38918,38980,39019,39071,39157,39182,39315,39328,39348,39563,39567,39589,39669,39684,39793,39812,39901,39969,40045,40172,40363,40369,40378,40667,40795,40878,40911,41010,41053,41071,41304,41630,41689,41693,41696,41798,41854,41883,41928,42030,42078,42381,42433,42438,42508,42510,42841,42886,42944,42983,43148,43155,43191,43217,43871,43873,43971,43983,44241,44328,44435,44537,44949,45266,45307,45382,45631,45761,45978,46120,46127,46179,46186,46216,46245,46314,46323,46325,46326,46453,46624,46631,46636,46670,46733,46822,47083,47127,47161,47243,47288,47299,47592,48014,48186,48208,48263,48465,48593,48634,48856,48940,49005,49007,49052,49060,49167,49222,49224,49312,49354,49410,49447,49553,49627,49743,49871,49891,638,821,1564,1574,1699,1957,2029,2107,2155,2308,2443,2519,2522,2725,2801,3143,3239,3446,3457,3539,3633,3870,3902,3922,3957,4042,4411,4668,4973,5478,5520,5583,5626,5864,5960,6072,6806,6855,6876,6937,7378,7669,7730,7918,7967,8088,8108,8126,8300,8342,8401,8657,8672,8704,8777,8981,9011,9665,9960,10310,10418,10687,10939,11007,11238,11294,11554,11579,11625,11631,11802,11871,12112,12377,12557,12647,12932,13008,13108,13233,13330,13580,13738,13908,13980,14184,14342,14348,14722,15165,15608,15628,15757,16146,16176,16186,16815,17204,17268,17296,17339,17924,17971,18033,18185,18350,18372,18379,18402,18516,18791,19084,19187,19380,19611,19623,19776,19818,20178,20243,20244,20568,21094,21119,21191,21217,21721,22088,22305,22380,22722,22733,22862,22998,23252,23256,23297,23332,23634,23650,23838,23927,24085,24303,24613,24735,24766,24789,24972,25499,26007,26080,26982,27067,27218,27253,27550,27555,27561,27685,27958,28035,28532,28561,28573,28836,29076,29412,29506,29830,29963,30209,30225,30935,31068,31159,31166,31281,31771,32105,32772,32937,33018,33115,33270,33286,33507,33623,33676,33861,33940,34085,34359,34434,34554,34628,34922,34958,35510,35741,35760,35884,35956,36126,36205,36289,36413,36591,36860,37006,37091,37148,37209,37305,37402,37569,37662,37664,37959,37975,38170,38196,38311,38354,38998,39645,40154,40215,40327,40432,40440,40538,40643,40768,40800,41060,41088,41129,41624,41778,42041,42435,42624,43079,43220,43346,43538,43642,43665,43689,43849,43863,43886,43916,44021,44204,44923,45353,45564,45949,45974,46227,46406,46458,46495,46610,46657,46929,47022,47496,47670,47749,48065,48292,48333,48416,48438,48444,48720,48872,48991,49245,49584,49769,49777,49895,49911,175,279,595,746,819,865,1321,1529,1734,1857,2644,3032,3512,3720,3879,3931,4174,4496,4524,4724,4760,4872,5497,5629,5735,5821,6025,6075,6309,6398,6607,7183,7476,7541,8004,8743,8893,9100,9147,9894,10048,10321,10373,10892,11136,11646,11966,12098,12513,12559,12715,12828,12895,13157,13227,13305,13346,13593,13659,13887,13953,13974,14062,14098,14937,15004,15052,15059,15121,15498,15927,16618,16846,16851,16980,17229,17942,17959,18587,18682,18822,18847,19384,19431,19534,19657,20040,20229,20466,21046,21181,21201,21343,21450,21905,22059,22292,22578,22897,23104,23120,23245,23424,23544,23589,24253,24265,25022,25513,25709,25799,26106,26147,26453,26572,26701,26743,26821,26931,26989,27410,27554,27643,27752,27918,28252,28253,28858,28923,28946,29636,29771,29857,30043,30168,30290,30377,30514,30643,30813,31586,31865,32167,32207,32389,32709,32841,33022,33256,33400,33685,33773,33900,33949,34622,34626,34751,34920,35109,35161,35246,35347,35679,35879,36029,36383,36486,36531,36567,36938,37352,37592,38416,38590,38599,38688,38772,38810,39188,39414,39855,40038,40277,40322,40358,40647,40868,41151,41215,41478,41538,41685,42083,43021,43120,43151,43231,43252,43977,44168,44845,44907,45270,45440,45581,45987,46224,46415,46680,47120,47266,47438,47845,47964,48266,48483,48712,49805,49814,312,652,1006,1013,1104,1257,2016,3789,4364,4581,4762,4936,5234,5277,5547,5657,5947,6151,6399,6546,6570,6791,6933,7046,7778,8131,8301,8618,8786,9576,9897,10027,10145,11144,11230,12804,12921,13819,13864,14162,14531,15277,15419,16501,16700,16742,17179,17868,17897,18069,18882,18966,19322,19789,20506,20578,20805,21413,21484,21561,22617,22860,23632,23994,25118,25386,26059,26746,26797,26828,27454,27522,27542,28880,28926,29021,29199,29342,29715,30331,30422,31388,31484,31789,32321,32494,32669,32796,33901,34379,34646,34660,34696,35565,35599,35880,36086,36223,36879,37031,37270,37535,37767,37827,37906,38351,38363,38407,39891,40032,40165,40181,40688,40702,41014,41240,41586,41678,42067,42966,43025,43531,43589,43882,44128,44631,44730,44765,44819,45176,46166,46350,47063,47238,47634,47645,47979,49268,49331,49548,49934,418,592,980,1510,1685,3323,3438,3906,4747,5034,5280,6138,6291,6388,8699,9045,9241,10475,10726,10748,10764,12296,12783,12841,13415,13827,14760,15058,15082,15156,16145,16147,17068,17970,19910,19969,20381,22046,22458,23214,23551,23833,25072,25396,26495,26695,26973,27620,28589,29092,30702,31023,31048,31210,33457,33461,33829,33888,34356,34428,34553,35562,35821,36605,37257,37851,37994,38181,38409,38768,38840,39484,40184,40250,41261,41408,41556,42040,43440,45624,46171,46291,46533,46825,47609,47803,48575,48954,4006,5792,6187,6232,6699,6979,9244,9384,9759,9993,10368,10630,11251,11363,11850,14652,16436,16717,17214,17263,17624,18393,19194,19875,22587,23020,23912,24333,25025,}
	s[2]=[]int{97,143,161,224,252,565,632,668,947,965,1270,1361,1399,1442,1451,1635,1637,1639,1702,1979,1993,2015,2168,2177,2184,2230,2236,2256,2285,2483,2592,2641,2685,2908,2909,3193,3354,3472,3502,3711,3868,3901,3926,3978,4032,4094,4162,4173,4228,4255,4289,4350,4478,4514,4775,4883,5181,5208,5312,5353,5364,5408,5518,5652,5718,5987,6082,6343,6673,6730,6944,7014,7100,7213,7267,7285,7708,8066,8153,8242,8252,8286,8361,8437,8485,9014,9154,9315,9329,9529,9548,9618,9724,9830,9888,10026,10116,10323,10376,10403,10688,10866,11014,11201,11446,11652,11683,11749,11771,12036,12163,12316,12872,13015,13129,13661,13950,14021,14268,14346,14392,14742,15040,15051,15083,15353,15386,15623,15715,15726,15812,15928,16053,16172,16249,16297,16319,16325,16475,16850,16916,17040,17137,17259,17395,17538,17567,17590,17616,17727,17766,17813,17829,17878,17946,18141,18162,18296,18776,18949,19219,19248,19405,19480,19624,19742,19784,19894,19986,20098,20230,20289,20323,20358,20421,20449,20513,20515,20595,20599,20755,20763,20838,20847,21075,21127,21139,21317,21456,21636,21673,21903,21915,21983,22349,22518,22577,22801,22834,22891,23149,23185,23244,23260,23361,23451,23605,23616,23654,24168,24191,24341,24363,24428,24604,24738,24762,25055,25224,25325,25435,25473,25586,25674,25930,25940,26121,26176,26280,26350,26652,26851,27389,27462,27570,27647,27648,27983,27987,28063,28170,28219,28475,28999,29105,29278,29554,29573,29671,29720,29749,29755,29768,30017,30059,30118,30148,30803,30849,31343,31376,31475,31600,31610,31615,31738,32027,32266,32312,32361,32364,32552,32564,32577,32638,32715,32744,32780,33031,33194,33250,33409,33482,33492,33563,33587,33679,33834,33864,33880,33899,33926,34066,34079,34183,34383,34386,34478,34510,34534,34789,34829,34836,34921,35024,35033,35182,35193,35284,35384,35560,35627,35814,35937,36011,36115,36124,36238,36681,36788,36970,36996,37296,37335,37461,37546,37697,37812,38101,38153,38270,38414,38497,38519,38616,38648,38693,38701,38842,38925,38995,39080,39119,39247,39323,39371,39444,39478,39631,39640,39659,39674,39774,39941,39955,40259,40309,40431,40488,40594,40631,40707,40772,40779,40853,41271,41302,41318,41414,41613,41655,41682,41771,41819,41820,42020,42127,42138,42220,42260,42564,42835,42868,42945,43010,43093,43341,43393,43396,43516,43641,43763,43888,44032,44050,44240,44281,44295,44635,44637,44684,44727,44743,45102,45125,45178,45252,45267,45453,45681,45711,45926,46283,46286,46429,46724,47094,47251,47359,47393,47488,47707,48265,48319,48637,48763,49063,49099,49264,49337,49384,49499,49577,49594,49651,49902,173,366,368,479,735,1019,1056,1060,1156,1325,1357,1427,1654,1907,1938,2129,2133,2189,2279,2684,2714,2889,3118,3188,3543,3549,3572,3612,3859,4034,4074,4151,4453,4475,4637,4652,4657,4712,4786,4835,5191,5357,5359,5401,5458,5578,5674,5818,5966,6283,6454,6566,6987,7041,7373,7507,7757,7857,8124,8250,8512,8604,8701,8764,8895,9434,9582,9667,9712,9812,9901,9907,9979,10093,10366,10397,10414,10564,11366,11367,11448,12090,12280,12300,12512,12571,12582,12958,13147,13188,13303,13669,13727,13746,13943,14072,14215,14434,15201,15220,15222,15354,15512,15964,16355,16538,16641,16659,16679,16741,17154,17219,17260,17293,17344,17361,17477,17570,18258,18341,18490,18524,18578,18668,18918,19297,19330,19376,19419,19872,20272,20465,20473,20542,20576,20651,20655,21025,21604,21610,21642,22027,22113,22183,22351,22487,22501,22645,22655,22855,23008,23115,23122,23160,23166,23298,23387,23395,23411,23684,23820,23870,24060,24197,24338,24350,24625,25024,25249,25388,25440,25652,25693,26156,26171,26414,26566,26576,26744,26805,26923,26964,27515,27741,27880,27956,28204,28395,28450,28554,28611,29006,29022,29085,29175,29268,29725,29929,29960,30016,30070,30106,30244,30314,30385,30434,30467,30473,30485,30579,30744,30825,30887,30891,31097,31431,31492,31583,31607,31709,31863,32381,32386,32438,32581,32614,32687,32689,32906,33100,33294,33319,33357,33584,33674,33963,34105,34303,34385,34489,34764,34826,34910,34971,35097,35199,35208,35236,35344,35473,35508,35516,35727,36002,36070,36285,36487,36621,36635,36685,36767,37051,37150,37414,37468,37938,37974,37985,37992,38073,38175,38249,38277,38461,38782,39027,39473,39646,39722,39735,40010,40075,40106,40248,40360,40579,40591,40818,41287,41400,41611,41762,41860,41974,42203,42403,42594,42708,42772,42798,42871,42988,43054,43128,43269,43392,43535,43668,43836,44314,44513,44784,44785,44873,44904,45056,45509,46005,46146,46184,46344,46352,46669,46674,46690,46803,47040,47347,47439,47449,47629,47733,48180,48183,48245,48484,48685,49012,49057,49109,49132,49282,49756,49808,49920,49976,349,396,402,844,1077,1088,1439,1836,1900,1965,2546,2624,2697,2717,3133,3244,3256,3518,3614,3777,3893,3963,4143,4440,4609,4812,4912,5230,5540,5668,5941,6064,6282,6715,6959,6994,7179,7191,7383,8017,8280,8296,8417,8438,8611,8716,8798,8814,8833,8915,9009,9135,9464,9728,9823,9836,9866,9959,10298,10551,10629,10981,11074,11085,11180,11552,11663,11681,11696,11920,12256,12270,12950,12975,13088,13372,13533,13752,14101,14113,14228,14332,14404,14701,14977,15008,15144,15241,15568,15835,15859,16063,16196,16650,16835,16943,17131,17207,17320,17349,17376,17426,17462,17509,17560,17674,17698,17764,18054,18196,18220,18536,18549,19217,19348,19636,20075,20344,20480,20588,21297,21504,21911,21946,21979,22092,22666,22793,22827,22902,23097,23151,23357,23630,23723,23963,24069,24121,24267,24408,25061,25106,25147,25185,25232,25234,25237,25437,25466,25594,26042,26120,26319,26332,26401,26500,26858,27043,27145,27204,27376,27644,27802,28034,28088,28108,28520,28542,28601,29041,29207,29227,29282,29350,29365,30011,30074,30279,30364,30597,30602,30666,30802,31009,31042,31076,31101,31230,31353,31436,31505,31656,31754,31824,32201,32339,32344,32509,32611,32629,32749,33068,33246,33307,33691,33724,33903,34063,34382,34477,34676,35016,35104,35691,36180,36181,36281,36351,36412,36807,36980,37108,37237,37455,37456,37873,37973,38156,38201,38254,40155,40803,40913,41265,41742,41840,41875,41999,42051,42153,42370,42647,42680,42857,43075,43190,43365,43564,43704,43715,43819,43947,44061,44100,44249,44370,44432,45157,45265,45430,45493,45654,45715,45864,46267,46336,46446,46508,46553,46857,46878,46957,47396,47607,47672,47728,48095,48185,48218,48813,48817,48983,49249,49338,49340,49477,49513,49591,49644,49765,49767,33,206,225,309,333,577,603,666,720,784,788,911,992,1164,1287,1359,1727,1911,2063,2088,2251,2579,2601,2759,2766,2830,2896,3439,3525,3579,4117,4319,4326,4367,4421,4447,4521,4525,4679,4817,4882,4925,5202,5215,5229,5267,5472,5492,5609,5794,5965,6226,6323,6476,6962,7137,7309,7320,7441,7478,7515,7737,7928,8030,8494,8553,8673,9546,9710,10025,10095,10138,10388,10456,10677,10821,11170,11175,11195,11369,11423,11528,11763,11918,11947,12028,12114,12132,12845,13096,13496,13615,14274,14283,14321,14416,14440,14461,14593,14681,14714,14910,15075,15117,15158,15340,15856,15947,16011,16128,16161,16225,16433,16450,16750,16754,16812,17032,17210,17213,18066,18145,18147,18209,18216,18515,18568,18750,19022,19158,19211,19915,20157,20636,21286,21470,21557,21564,21575,21629,21835,22314,22318,23351,23488,23538,23578,23745,24189,24245,24329,24464,24594,24682,24727,25051,25108,25322,25695,26238,26305,26307,26395,26450,26532,26543,26812,26854,27131,27206,27229,27370,27415,27559,27604,27628,27665,27677,28292,28350,28609,28637,29117,29230,29300,29429,29468,29957,30367,30387,30394,30403,30593,31538,31672,31751,32264,32674,32779,32974,33495,33690,33717,33977,34238,34397,34494,34960,35197,35455,35456,35616,35973,35981,36245,36766,36915,36965,37158,37389,37600,37867,38395,38558,38571,38734,39352,39508,39577,39731,39915,40185,40373,40629,40854,40948,41017,41935,42021,42289,42395,42499,42548,42684,42793,42887,43026,43045,43307,43319,43507,43758,43825,43850,44058,44095,44251,44536,44679,44736,44894,44896,45205,45562,45752,45815,46461,46837,46982,47020,47427,47437,47724,47746,47759,47885,47926,48133,48211,48829,49310,49852,67,234,281,317,394,410,537,681,1100,1144,1160,1389,1617,1672,1851,2065,2204,2348,2687,3233,3631,4218,4767,4992,5077,5536,5588,6530,6890,7105,7536,7554,7759,7901,8007,8078,8147,8298,8302,8506,9134,9452,9983,10037,10331,10583,10594,10693,10865,10927,11025,11334,11661,11848,12130,12943,13149,13416,13423,13486,13494,13501,13567,13631,13945,13997,14360,14405,14525,14783,14804,15028,15053,15072,15189,15627,15651,16004,16019,16110,16174,16210,16259,16683,16691,16847,16989,17021,17232,17336,17368,17700,17815,17854,18000,18247,18409,18448,18648,18679,18719,19064,19065,19395,19522,19554,19770,19873,19953,20340,20549,20666,20684,20734,21010,21014,21041,21074,21292,21519,21525,21625,21816,22016,22024,22267,22290,22519,22744,22838,22944,22975,23102,23533,24046,24165,24228,24612,25082,25288,25511,25562,25610,25741,25917,25918,26002,26352,26409,26507,26620,26686,26807,26912,27002,27053,27087,27187,27316,27347,27681,28165,28222,28466,28469,28488,28759,28990,29217,29310,29386,29435,29439,29687,29903,29906,29991,30187,30704,31049,31203,31704,31830,32184,32209,32431,32521,32579,32685,33242,33797,33840,33887,33924,34030,34148,34257,34488,34757,34767,35214,35219,35260,35469,35631,35774,35856,35980,36299,36333,36346,36432,36554,36562,37068,37101,37271,37421,38173,39017,39279,40001,40082,40090,40173,40474,40521,40637,41169,41365,41384,41719,41829,42371,42529,42583,42738,42748,42754,42803,42855,43338,43686,44287,44358,44369,44979,45496,45537,45642,45709,45801,45853,46038,46128,46230,46396,46700,46751,46923,46983,47070,47785,47938,48157,48519,48645,49325,49345,49348,49363,49375,49459,49660,49723,49834,101,610,704,952,969,1001,1237,1271,1300,1587,1984,2241,2316,2469,2897,2958,3051,3200,3321,3443,3793,4102,4120,4169,4580,4618,4819,4833,5307,5328,5381,5417,5633,6145,6198,6216,6221,6357,6763,6847,6921,6977,7217,7368,7516,7550,7933,8072,8181,8423,9146,9536,9559,10167,10217,10338,10462,10529,10852,11204,11355,11481,11617,11786,11924,12012,12305,12362,12433,12490,12520,12722,13201,13308,13354,13419,13592,13929,14231,14257,14312,14873,15470,15474,15480,15526,16444,16651,16710,16768,16889,17050,17133,17446,17592,17748,17989,18021,18387,18408,18537,19089,19301,19604,19658,19809,19853,19970,20726,21225,21475,21534,21551,21675,21735,21839,21954,22087,22089,22504,22604,22726,23275,23402,23666,23868,23941,24221,24356,24388,24463,24472,24949,24957,24958,25028,25074,25146,25207,25273,25345,25485,25577,26203,26470,26577,26895,26972,27042,27240,27743,27874,28004,28232,28538,28672,29680,29920,30231,30757,30983,31152,31452,31535,31715,31817,32052,32135,32174,32223,32366,32726,32953,33347,34407,34822,34840,35362,35420,35555,35681,35883,35907,35910,35948,36470,36564,36711,36805,36819,36891,37066,37123,37832,37987,38186,38309,38340,38417,38464,39260,39687,39925,40428,40754,40885,40904,41255,41327,41433,41599,41618,42080,42243,42514,42747,42779,43001,43572,43596,43681,43714,43733,43867,44057,44344,45063,45335,45953,46110,46538,46810,46947,47050,47254,47264,47344,47460,47973,47994,48399,48415,48521,48549,48641,48703,49038,49064,49148,49155,49535,49578,49581,49614,49642,49676,49917,49927,89,213,257,301,578,714,751,854,986,1046,1067,1176,1194,1227,1633,1823,2191,2513,3114,3226,3888,3977,4050,4178,4232,4428,4486,4796,4855,4964,5004,5331,5376,5543,5951,6023,6518,6702,6802,6860,6884,6943,7020,7382,7397,7559,8009,8409,8601,8717,8782,9102,9321,9371,9580,9638,9661,9734,9953,10077,10089,10229,10539,11213,11328,11968,12067,12216,12382,12549,13073,13153,13284,13735,14352,14391,14828,15157,15694,15834,15864,16331,16507,16587,16930,17422,17429,17649,17715,17724,17851,17991,18058,18151,18168,18173,18386,18704,18837,18865,18877,18930,19001,19070,19141,19144,19814,19858,20203,20293,20926,21171,21347,21362,21372,21812,22104,22609,22641,23088,23235,23240,23372,23720,23735,23788,23856,24012,24104,24161,24407,24694,24826,24896,25406,25475,25716,25800,26263,26303,26362,26379,26479,26519,26627,26715,26809,26893,27011,27025,27082,27146,27166,27210,27311,27851,27856,28099,28158,28315,28383,28586,28994,29061,29678,29926,30040,30090,30642,30759,30804,30857,30879,30881,31093,31277,31740,32081,32136,32254,32276,32304,32357,32515,32705,32783,32889,33300,33434,33455,33905,34007,34483,34647,35106,35389,35594,35767,35807,35933,36101,36150,36743,36780,37180,37329,37522,37630,37940,38057,38063,38096,38211,38268,38422,38916,39224,39330,39737,40107,40845,40956,41056,42019,42084,42114,42168,42172,42221,42344,42421,42445,42527,42588,42713,42873,43454,43600,43943,44051,44138,44917,45147,45505,45544,45611,45675,46126,46556,46760,46771,46950,46978,47225,47537,47620,47995,48354,48368,48602,48689,49014,49053,49540,49621,49716,49786,49837,49874,34,71,708,780,1040,1131,1307,1322,1420,1448,1480,1499,1829,1868,2061,2071,2078,2079,2160,2185,2266,2388,2627,2724,2741,3105,3338,3590,3942,4047,4213,4229,4474,4691,4705,4928,5164,5365,5411,5563,5940,6020,6063,6131,6217,6279,6390,6395,6441,6583,6628,7336,7474,7660,7673,7815,7905,8145,8226,8313,8551,8724,8841,8926,9001,9405,9800,10274,10304,10305,10434,10470,10514,10619,10626,10807,10839,11340,11411,11430,11476,11537,11987,12297,12586,12593,12623,12709,13301,13426,13535,13757,13900,14005,14059,14071,14398,14613,15000,15015,15074,15368,15481,15597,15772,15956,16112,16405,16470,16745,16925,17019,17503,17563,17994,18133,18339,18414,18425,18606,18819,19258,19333,19505,19664,19825,19984,19992,20366,20558,20960,21109,21140,21285,21319,21395,21434,21662,21674,21803,21806,21994,22036,22808,23009,23787,24396,24656,24709,24821,24946,25039,25172,25737,25780,25999,26175,26345,26357,26415,26515,26596,26623,26634,26838,27088,27124,27551,27651,27906,27937,27961,27995,28111,28115,28346,28456,28819,29417,29617,29764,30179,30261,30404,30569,30865,31022,31175,31720,31723,31742,31797,31972,32142,32286,32460,33071,33160,33171,33205,33265,33326,33757,33928,34175,34327,34389,35066,35075,35580,35625,35639,35924,36259,36713,36753,36769,36916,37232,37399,37891,38019,38145,38481,38567,38620,38956,38979,39049,39137,39326,39427,39437,39464,39602,39837,40526,40589,41064,41294,41736,41789,41894,42297,42298,42328,42458,42602,43204,43584,43621,43675,43915,44304,44359,44594,44823,44832,45336,45501,45603,45650,45689,46202,46268,46510,46648,46714,46920,47197,47306,47473,47667,47761,47838,48084,48161,48248,48351,48383,48386,48480,48553,48611,49071,49126,49817,210,562,587,598,860,1047,1117,1183,1323,1604,1619,1667,1799,1939,1949,2471,2898,3144,3420,3587,3886,4065,4090,4186,4398,4402,4451,4607,4716,5258,5715,5857,5887,6030,6176,6210,6428,6536,7414,7637,7743,7912,9142,9427,9462,9592,9627,9763,9771,9794,9954,10024,10102,10423,10595,10870,11110,11548,12243,12321,12325,12484,12574,12602,12640,12922,13121,13273,13702,13913,13938,14409,14455,14555,14611,14854,15196,15275,15463,15489,15618,15740,15782,15925,16100,16263,16346,16800,16885,16902,17250,17303,17660,17697,17713,17772,17811,18011,18174,18651,18766,18817,18844,18853,18890,18998,19156,19650,19926,20018,20195,20225,20461,20675,21164,21493,21643,21899,22176,22287,22321,22620,23043,23325,23754,23882,24755,24850,25160,25191,25279,25395,25642,25837,25881,25894,25996,26383,26864,26991,27018,27233,27447,27495,27638,27998,28372,28452,28727,28794,29047,29102,29352,29443,29538,29566,29593,29748,29801,29888,30077,30100,30447,30680,30783,30882,30903,31319,31457,31703,32159,32455,32594,32724,32819,33387,33523,33609,33671,33939,33997,34367,34380,34582,34584,34744,34759,35283,35743,35909,35986,36261,36672,36785,36852,36923,37128,37428,37644,37699,37762,37993,38183,38769,38819,38922,39154,39500,39513,39536,39585,39822,40337,40392,40540,40695,40725,40952,41040,41250,41360,41481,41482,41703,42730,42759,42906,43399,43445,43458,43543,43546,43633,43728,43740,43906,43910,43932,44047,44185,44346,44463,44483,44826,44986,45097,45134,45142,45697,45999,46129,46181,46617,46845,46895,47572,48040,49305,49474,49661,49672,1186,1288,1491,1546,1705,1788,1923,2031,2162,2628,3316,3670,3758,3907,4105,4275,4382,4624,4963,5335,5499,5770,5841,5871,6215,6493,6669,7442,7448,7617,7786,7799,8018,8216,8316,8383,8749,8760,9042,9326,10061,10543,10691,10917,10926,11247,11262,11938,12007,12109,12291,12609,12653,12751,12961,13001,13037,13084,13695,13823,13912,14076,14318,14491,14511,14552,14708,14736,15405,15706,16109,16141,16357,16368,16542,17145,17220,17346,17363,17751,17757,18019,18039,18278,18353,18373,18415,18623,18824,19075,19121,19192,19484,19651,19699,20692,21461,21546,21678,21726,21851,22545,22672,22866,22982,23024,23073,23742,24380,24394,24493,24527,24669,24969,25117,25552,25991,26044,26264,26275,26295,26694,26941,27010,27176,27314,27439,27464,27664,28208,28359,28373,28393,28540,28668,28918,29163,29377,29626,29669,30275,30285,30747,30957,30984,31177,31415,31788,31917,31949,32035,32522,32691,32881,32962,33021,33130,33512,33519,33524,33574,33791,33815,34010,34189,34476,34495,34783,34879,35039,35092,35194,35337,35363,35843,36062,36287,36416,36818,36987,37082,37131,37470,37543,37620,38202,38258,38509,38603,38669,38813,39059,40056,40821,41047,41096,41288,41398,41429,41629,41842,41920,42334,42758,43023,43048,43104,43410,43749,44214,44417,44766,44827,45025,45126,45156,45206,45472,45824,45971,46105,46119,46420,46539,46767,47100,47195,47230,47459,47602,47814,48034,48268,48449,48486,48556,48564,48984,49339,49400,49405,49789,188,267,290,391,534,631,895,1049,1115,1259,1787,2356,2429,2437,2543,2673,2755,2793,3070,3134,3142,3656,4399,4894,4987,5057,5330,5476,5493,5509,5576,5825,5889,5903,7236,7274,7327,7371,7467,7621,7733,7780,7848,8372,8563,8684,8757,9021,9088,9167,9178,9991,10512,10990,11182,11466,11691,11710,12010,12218,12996,13032,13182,13204,13531,13537,13718,13788,13889,14273,14490,14505,14700,15003,15395,15724,15872,15937,16022,16277,16287,16379,16443,16494,16681,16854,17269,17323,17483,17576,17699,17780,17807,17871,18077,18134,18146,18985,19278,19296,19401,19492,20011,20569,20608,20736,20818,20949,21012,21146,21556,21766,21842,22013,22273,22405,22592,22650,22704,22858,22938,22970,23091,23124,23637,23898,23920,23985,24510,24526,25167,25532,25617,25798,25885,26322,26403,26434,26545,26835,26875,26959,27031,27171,27184,27516,28166,28454,28566,28655,29409,30212,30254,31609,31729,31795,31799,31838,32269,32721,33285,33709,33802,33969,34248,34504,35118,35656,35793,35806,35954,35966,36648,36794,36846,37008,37213,37240,37424,37639,38011,38579,38657,39175,39300,39390,39512,39590,39592,39666,39825,40074,40239,40437,40484,40645,40846,40908,41042,41299,41337,41794,41882,42176,42320,43086,43798,44044,44094,44473,44565,44653,45008,45127,45169,45256,45607,45739,45968,46090,46270,46605,46656,46734,46864,46984,47056,47167,47330,47711,47857,47875,47963,48134,48227,48232,48805,48903,49120,49551,49616,49635,49639,126,155,576,700,742,876,1554,2275,2291,2496,2656,2833,3255,3527,3552,3688,4001,4057,4304,4511,4700,4937,4952,4961,5172,5678,6002,6224,6905,7017,7577,7692,7716,8090,8178,8259,8344,8358,8375,8718,8911,9064,9128,9338,9634,9930,10112,10557,10591,10718,10815,12258,12498,12762,12769,13228,13428,13455,13540,13565,13652,13849,13866,13956,13973,14026,14051,14202,14513,14753,15264,15346,15410,15436,15622,15771,16188,16270,16406,16591,16703,16951,17901,18116,18281,18302,18318,18383,18422,18457,18510,18920,18955,19125,19881,19979,20117,20328,20367,20545,20563,21501,21637,21638,21651,21742,21761,21882,21936,22160,22626,22771,22923,23404,23436,23478,23950,24011,24179,24202,24925,25217,25260,25292,25593,25796,26039,26108,26133,26320,26666,26688,27194,27375,27539,27999,28526,28583,29135,29301,29537,29652,29784,30258,30305,30481,31223,31226,31517,31649,31653,31901,31939,32049,32151,32293,32513,32536,32613,33070,33112,33430,33431,33772,33913,34102,34172,34219,34351,34378,34607,34894,34936,35181,35226,35277,35326,35709,35870,35974,36043,36431,36436,36475,36665,36752,36801,36843,36859,37281,37474,37677,37710,37835,37868,38245,38539,38546,38731,39010,39220,39396,39533,39541,39600,39630,39725,39860,39971,40124,40433,41022,41148,41253,41522,41851,42161,42698,42844,42884,43301,43712,43717,43720,43834,43950,43998,44018,44202,44205,44270,44349,44377,44589,44593,44694,44856,45313,46097,46137,46172,46306,46379,46397,46565,46931,47008,47175,48062,48140,48308,48364,48369,48787,49043,49262,49624,49954,63,111,405,584,747,896,1219,1295,1318,1345,1677,1683,1887,1952,2585,2773,3098,3320,3397,3630,4139,4256,5008,5131,5179,5201,5565,5920,6375,6598,6655,7106,7147,7225,7226,7427,7470,7689,8416,8447,8805,8948,9659,9864,10013,10216,10419,10549,10570,10645,10771,10905,11157,11226,11578,11796,11867,11975,12094,12483,12527,12726,12879,13111,13298,13667,13708,13734,13816,13923,14266,14323,14401,14512,14521,14578,14630,14669,14774,14793,14883,15042,15065,15522,15540,15760,15780,16018,16027,16073,16278,18048,18158,18532,18737,18804,18905,19010,19207,19340,19394,20030,20068,20186,20209,20341,20511,20536,20580,21313,21491,21633,21746,21770,21970,22008,22073,22240,22427,22560,22929,22948,23123,23208,23448,23673,23710,23794,23981,24035,24167,24276,24369,24422,24506,24898,24932,25629,25776,25902,25923,26009,26227,27208,27308,27595,27733,28041,28463,28660,28959,29331,29457,29509,30177,30534,30746,30806,31766,32123,32433,32924,33017,33058,33060,33075,33321,33334,33418,33554,33596,34388,34430,34627,34708,34986,35533,35597,35987,36162,36929,37037,37053,37264,37609,37659,37749,38058,38393,38465,38720,38887,39236,39447,39809,39882,40299,40551,40584,40701,40752,40843,41275,41407,41588,42398,42401,42402,42406,42703,43139,43162,43381,43859,44258,45070,45118,45318,45395,45478,45706,45763,45794,45883,46104,46139,46339,46731,46765,46945,47199,47363,47411,47412,47462,47480,47893,47980,47984,48132,48141,48417,48878,49058,49152,49200,49416,64,199,262,982,1253,1303,1646,1710,1748,1755,2362,2640,2807,2837,3177,3209,3428,3653,3813,3920,3958,4403,4667,4905,4922,5235,5427,6470,6691,7167,7364,7678,7816,7824,7863,7907,8068,8570,9024,9041,9155,9195,9811,10172,10187,10511,10969,11096,11197,11378,11413,11483,11486,11601,11760,12170,12220,12281,12283,12942,13110,13413,13591,13700,13834,13934,14086,14544,14563,14587,14889,15086,15356,15409,15801,15989,16033,16084,16303,16397,16656,17070,17159,17388,17448,17627,18279,18355,18620,18644,18769,18825,19338,19607,19807,20023,20055,20114,20136,20299,20490,20687,20707,20947,21326,21363,21754,21852,21878,21975,22901,23173,23292,23328,23366,23392,23607,23699,23707,24131,24268,24392,24570,24600,24793,24836,25340,26043,26239,26473,26900,27281,27507,27771,27965,28125,28202,28341,28548,28574,28782,28848,29223,29706,29918,30228,30249,30631,30682,30687,30800,30987,30997,31170,31440,31591,31592,31890,32088,32311,32518,32861,33048,33626,33792,33836,33876,35169,35418,35677,35788,36136,36251,36252,36268,36609,37341,37870,37972,38050,38349,38473,38606,38832,38892,39204,39253,39604,39685,39950,40063,40223,40286,40400,40633,40651,40884,41502,41510,41558,41775,42546,43247,43359,43391,43431,43893,43920,44632,44865,45149,45154,45242,45264,46242,46608,47138,47247,48054,48167,48233,48469,48740,48890,48927,49409,49479,49968,229,300,373,1193,1316,1573,1958,2099,2105,2392,2799,2947,3253,3654,4085,4142,5042,5137,5380,5396,5516,5768,6285,6565,6624,6887,7603,7701,8283,8455,8924,9200,9373,9395,9538,9914,10230,10244,10379,10622,10728,11872,12317,12826,13026,13297,13313,13534,13575,14280,14316,14658,14797,14824,15417,15483,15779,15800,15884,16049,16091,16481,16486,16727,16748,16883,17310,17463,17640,17696,17836,17880,18015,18287,18463,18597,18695,18720,19143,19525,19601,19811,20255,20410,21208,21211,21223,21416,21719,21776,21876,21893,21961,22127,22140,22324,22342,22387,22717,22757,22930,23054,23711,23712,24184,24409,24452,24470,24631,24718,24770,24928,25293,25353,25465,25961,26036,26086,26096,26111,26513,26547,26762,27003,27209,27262,27274,27339,27675,27793,27809,28119,28277,28289,29316,29650,29785,30123,30570,30670,30697,30835,31163,31167,31606,31986,32038,32042,32298,32807,32859,33028,33650,33681,33852,34099,34146,34259,34336,34405,34623,34876,35293,35383,35452,35551,36282,36331,36506,36518,36599,36691,36731,36822,37140,37315,38297,38367,38971,39000,39435,39507,39618,39717,39736,39810,40076,40609,41187,41233,41428,41788,42667,43016,43095,43334,43931,43964,43990,44079,44575,44620,44691,45128,45181,45423,45649,45901,46578,46915,47085,47151,47415,47520,47704,47811,47901,48243,48410,48513,48664,48833,49065,49373,49861,}
	s[3]=[]int{223,325,330,339,413,425,1054,1405,1691,1931,2052,2606,3458,3728,3778,3832,3842,3981,3998,4149,4222,4509,4572,4649,4726,5021,5063,5088,5317,5844,6021,6097,6314,6543,6741,6910,7269,7297,7380,7443,7627,7656,7877,8038,8103,8232,8592,8908,9057,9093,9284,9302,9487,9537,9747,9889,10657,10663,10863,10873,10999,11253,11394,11559,11961,12032,12102,12212,12535,12617,13209,13212,13441,13445,13697,13850,14673,14682,14936,15055,15729,15734,16342,16677,16957,17082,17617,17984,18073,18237,18554,18626,18638,19103,19189,19422,19430,19861,19880,20076,20156,20306,20725,20773,20896,20925,20952,21067,21320,21321,21850,22209,22524,23318,23399,23727,23798,23967,24696,24945,24964,25119,25309,25417,25882,26033,26272,26347,26364,26460,26509,26604,26929,27120,27321,27487,27552,27818,27933,28016,28071,28082,28112,28215,28342,28404,29051,29079,29097,29314,29380,29490,29816,30205,30274,30302,30482,30572,30732,31283,31404,31456,31584,31593,31885,32046,32139,32510,32659,32886,32916,33006,33231,33233,33464,33516,33816,33930,33953,34103,34590,34875,35149,35400,35618,35642,35979,36364,37098,37188,37262,37360,37426,37588,37860,37922,37948,38035,38055,38075,38079,38288,38411,38483,38597,38784,38873,38969,39063,39251,39346,39418,39670,39883,39887,40004,40207,40332,40406,40996,41229,41241,41274,41534,41982,42013,42162,42170,42185,42553,42575,42766,42807,43380,43390,43441,43573,43611,43980,44284,44347,44367,44860,45050,45232,45306,45412,45422,45648,45777,45831,45934,46075,46109,46879,46907,47187,47214,47301,47346,47373,47712,47864,47886,47923,48350,48663,49033,49234,49301,49307,846,903,1071,1155,1203,1863,1975,2120,2125,2337,2905,3111,3236,3268,3417,3696,3800,3908,4012,4200,4309,4501,4613,5128,5600,5783,5849,5994,6115,6137,6196,6569,6801,6808,6993,7471,7823,8102,8412,8473,8554,8658,8872,8964,9240,9545,9629,9649,9733,9946,10559,10924,11035,11186,11242,11464,11667,11943,11993,12016,12065,12140,12247,12429,13186,13585,14096,14284,14298,14445,14448,14717,14872,14922,15150,15307,15348,15978,16028,16064,16167,16213,16557,16585,16595,16631,16665,16829,17497,17707,17824,17983,18195,18316,18505,18632,19108,19270,19852,19939,19947,20187,20280,20451,20476,20537,20654,20856,21063,21220,21324,21400,21426,21531,21857,22072,22197,22358,22520,22679,23042,23136,23388,23690,23752,23774,24115,24339,24488,24524,24588,24659,24713,24828,25099,25295,25321,25354,25677,26224,26246,26840,27614,28017,29131,29236,29261,29464,29476,29639,29710,29719,29729,29754,29848,29853,29930,30085,30149,30204,30544,30818,31001,31061,31282,31339,31581,31899,32149,32257,32637,33332,33469,34016,34052,34363,34402,34775,35059,35272,35330,35585,35869,36068,36221,36579,37055,37488,37534,37849,38021,38158,38370,38668,38697,38891,38961,38996,39074,39114,39143,39277,39506,39740,39946,40187,40292,40390,40535,40728,41025,41049,41050,41226,41376,41616,41644,42037,42621,42677,42941,43018,43248,43274,43336,43630,43793,44112,44157,44280,44576,44669,44700,44780,44806,44924,45160,45257,45705,46149,46449,46464,46583,46752,46827,47318,47342,47362,47404,47468,47472,47869,47962,48012,48078,48091,48111,48176,48337,48652,48750,48859,49018,49420,49422,49433,49838,49924,13,19,78,207,250,455,703,752,1015,1035,1343,1470,1533,1569,1607,1616,1924,2180,3163,3694,4206,4568,4788,4794,5023,5569,5896,6067,6296,6854,7169,7307,7981,8085,8183,8957,9197,9254,9256,9740,9948,10097,10249,10422,10496,10552,10567,10681,10719,10749,10811,10819,10840,10962,11045,11327,11512,11863,11874,11951,12385,12499,12515,12581,12741,12850,13171,13363,13403,13493,13528,13740,13750,14145,14256,14374,14780,14857,15255,15287,16005,16387,16566,16855,17113,17228,17236,17318,17410,17572,17630,17754,17758,17977,18221,18377,18418,18504,18595,18645,18652,18760,19232,19339,19637,19709,20036,20096,20760,20862,21069,21288,21398,21420,21445,22297,22429,22786,22842,23176,23582,23606,23631,23724,23906,24056,24169,24590,24616,24684,24796,25103,25121,25307,25433,25559,26090,26248,26593,26671,26878,27094,27172,27302,27525,27590,27817,27828,27917,28267,28398,28578,28673,28957,29010,29196,29624,29734,30091,30240,30268,30380,30459,30665,31104,31124,31174,31317,31533,31601,31678,31714,31725,32087,33148,33385,33411,33789,33896,33922,33948,34542,34699,34997,35248,35373,35406,35766,35984,36645,36703,36775,36814,36834,36988,37143,37449,37618,37686,37759,37828,37950,37969,37970,38356,38736,38881,38948,39134,39434,39466,39694,39791,39861,40217,40344,40888,41134,41283,41417,42454,42836,42866,43050,43134,43207,43339,43371,43643,43822,44102,44261,44299,44392,44560,44658,44672,44912,45040,45148,45276,45652,45930,46030,46145,46180,46299,46405,46639,46807,47037,47133,47203,47252,47465,47505,47837,47991,48021,48316,48332,48356,48373,48378,48578,48999,49183,49357,49705,49974,247,315,549,1149,1401,1555,1796,1867,2173,2178,2498,2683,3083,3161,3280,3504,3681,3721,4771,5120,5180,5184,5314,5440,5541,5574,5635,5734,5921,6033,6058,6414,6825,6864,7237,7300,7919,7983,8032,8054,8999,9365,9557,9593,9721,9876,9956,10151,10295,11089,11129,11271,11274,11673,11903,11940,12138,12365,12444,12811,12994,13094,13218,13781,14028,14226,14510,14610,14832,14876,16232,16380,16477,16603,17025,17136,17167,17239,17440,17499,17529,17717,17722,17736,18301,18543,18662,18790,18994,19123,19129,19275,19370,19414,19513,19592,19610,19688,19884,20441,20936,21100,21549,21607,21718,21818,22316,22511,23378,23437,23471,23785,23854,23869,24078,24172,24645,25085,25271,25400,25424,27009,27697,27980,27991,27994,28198,28288,28530,28638,28641,28862,28984,29862,29907,30007,30020,30132,30185,30189,30247,30410,30435,30583,30876,30977,31045,31215,31580,31783,31940,32194,32203,32365,32380,32555,32790,33152,33296,33838,34221,34255,34425,34493,34957,35608,35786,36148,36451,36598,36812,36820,36851,37336,37652,37698,38118,38169,38218,38906,39112,39638,40071,40386,40420,40928,41006,41107,41119,41216,41326,41465,41523,41981,42089,42522,42599,44257,44415,44490,44511,44671,45048,45190,45239,45723,45797,46448,46750,46900,47053,47131,47147,47190,47272,47443,47511,47850,47929,47939,47987,48344,49275,49640,49832,49950,49994,415,569,2434,2619,2645,3535,3556,4002,4192,4294,4564,4750,5087,5093,5446,5474,5883,6068,6128,6249,6647,6796,7348,7563,7871,8220,8333,8397,8676,8896,9295,9409,9413,9481,9600,9664,10177,10205,10317,10589,10954,11211,11603,11609,11797,11811,12860,13226,13464,14299,14372,14703,14798,15095,15682,15786,16024,16130,16218,16311,16512,16910,17149,17750,17776,18109,18192,18599,18782,18989,19203,20097,20288,20708,22084,22156,22289,22298,22816,22926,22977,23108,23248,23660,23931,23957,24164,24365,24404,24443,24552,24666,25023,25379,25680,25805,25970,26187,26392,26463,26483,26553,26561,26696,27030,27592,27780,27862,28069,28691,28704,28895,29008,29033,29460,30203,30284,30567,30770,31357,31494,31990,32056,32219,32393,32964,33036,33138,33313,33420,33688,33898,34033,34129,34420,34733,35119,35312,35484,36046,36253,36519,37334,37695,37884,38133,38161,38462,38536,38671,38690,38855,39329,39806,39926,40002,41113,41131,41147,41181,41242,41258,41735,41785,41949,42008,42028,42314,42393,42394,42419,42802,42822,42912,43153,43251,43257,43541,43742,43856,44062,44408,44602,44812,44874,44891,44997,45064,45251,45566,45676,46337,46478,47146,47236,47686,47779,47860,48152,48169,48505,48528,48584,49035,49087,49117,49255,49372,49426,49757,49779,49938,960,1249,1371,1469,1558,1758,1849,2186,2402,2557,2767,2804,2882,3317,3342,3742,3862,4084,4601,4818,4844,5199,5754,5931,6153,6333,6600,6630,6942,7215,7885,7934,8089,8367,8474,9374,9520,9701,9963,10737,10913,10936,11635,11873,12441,12637,12886,13314,13365,13787,13815,14025,14992,15301,15704,16229,16371,16612,16662,16744,17543,17793,17825,17844,18026,18038,18410,19247,19444,19806,19888,20245,20754,20928,21458,21586,21722,21841,21883,22053,22506,23472,24677,24848,25006,25033,25138,25285,25289,25358,25728,25816,25867,26214,26761,27127,27179,27363,27566,27839,29107,29505,29850,29863,29914,29976,30131,30590,30752,30829,30926,31137,32094,32756,32761,32770,32869,32978,33089,33195,33206,33399,33597,33778,33906,33981,34633,34849,35328,35849,36833,36897,36959,36977,37105,37181,37187,37483,37636,38773,38900,38914,38943,39351,39551,39651,39850,39900,40500,40679,40970,41512,41991,42011,42017,42187,42676,43100,43143,43212,43320,43370,43389,44093,44171,44274,44465,45529,45541,46226,46372,46558,46666,47055,47057,47665,47693,47765,47800,48407,48743,48997,49021,49102,49129,49179,49778,127,230,338,367,711,1511,2295,2583,2631,2699,3005,3394,3475,3601,3753,3851,4415,4422,4518,4986,4999,5445,5502,5568,5644,5746,5877,6125,6361,6498,6539,7001,7426,7653,7724,7859,7913,8326,8781,8875,9039,10062,10290,10409,11065,11137,11289,11337,11909,12049,12055,12438,12774,12955,13211,13511,13602,13955,14022,14241,14289,14900,14932,14991,15091,15309,15454,15645,15688,15914,15998,16116,16144,16160,16993,17467,17494,17591,17607,19036,19429,19777,19831,19967,20593,21186,21473,21558,21860,21956,22484,22547,22549,23035,23125,23508,23562,23583,24141,24437,24676,24906,25062,25469,25575,26406,26522,26589,26656,26823,27118,27476,27503,28103,28643,28874,29240,29909,29984,30086,30586,31735,32008,32382,32495,32877,33264,33344,33577,33665,33966,34004,34194,34441,34579,34755,34855,34861,35128,35302,35574,35938,36024,36142,36178,37088,37422,38012,38142,38255,39682,40268,40486,40895,40938,41366,41450,43114,43213,44200,44592,44814,45184,45653,45692,45828,46794,46972,47051,47265,47313,47389,48701,48847,49098,49451,49604,58,269,993,1258,1498,1660,1807,1966,2046,2333,2693,2914,3079,3615,4544,4859,5222,5363,5507,5575,5667,6107,6406,6735,6766,6939,7129,7466,7706,7784,9061,9392,9873,10384,10395,10471,10659,10893,10897,11539,11629,11711,11944,12369,12418,12629,12964,12979,13187,13194,13633,13984,14027,14647,15350,15390,15677,16179,16251,17104,17233,17523,17561,17628,18056,18343,18542,18602,18712,18764,19023,19093,19241,19391,19962,19997,20376,20895,21150,21153,21189,21758,22213,22723,23728,23834,23929,24014,24745,25058,25432,25623,25692,27106,27676,27748,28077,28153,28396,28620,29000,29292,29448,29934,30029,30342,30420,30507,30838,31057,31158,31534,31603,31739,31746,31779,32107,32410,32896,33749,33868,34012,34498,34664,36109,36231,36824,36955,37103,37119,37365,37387,37806,37834,37963,38324,38529,38640,38850,38935,38951,39022,39051,39553,39761,40065,40343,40418,41307,41368,41519,41619,41642,41855,42408,42612,42781,43112,43211,43342,43726,43737,43805,44161,44356,44831,44895,45065,45327,45363,45432,45894,46541,46620,46649,47865,47922,47996,48456,48471,48724,48757,48822,49392,49485,49586,49963,251,459,745,815,1630,2305,2517,4697,4709,5174,5259,5632,5670,5943,6294,6304,6349,6654,6816,7286,7480,7699,7937,8064,8265,8792,9208,9317,9322,9530,9708,9765,9772,9784,9971,10012,10180,10189,10237,10449,10453,10879,11217,11439,11712,12169,13507,13680,14260,14340,14370,14494,15289,15392,15459,15554,15907,16140,16154,16420,16432,16534,16570,17458,17633,18032,18108,18308,18555,18666,19126,19180,19335,19514,19700,19805,19819,20014,20115,20166,20394,20457,20746,21047,21337,21345,21630,21702,22228,22295,22644,22737,23266,23502,23876,23903,24101,24675,24775,24801,25144,25815,26167,26750,27008,27024,27081,27491,27899,28758,28894,29340,29545,29728,29858,29873,30012,30219,30347,30568,31217,31622,32195,32331,32341,32367,32528,32668,33131,33544,33785,34045,34091,34705,34707,34804,35271,35620,36283,36476,36595,36779,36907,36997,37011,37248,37627,37962,38036,38042,38078,38386,38396,39150,39438,39475,39711,39734,39805,40086,41418,41722,41832,41957,41980,42321,42790,42947,42973,43250,43455,43506,43532,43852,44254,45263,45646,45774,45980,46032,46500,46773,46964,47924,47998,48104,48336,48362,48583,48630,48780,48930,49198,49289,49388,49469,556,1583,1684,1842,2197,2244,2968,2995,3164,4097,4158,4423,4555,4653,4707,5777,6255,6849,7035,8094,8905,9175,9641,9645,9820,9831,10299,10651,10670,10702,10804,11145,11255,11403,11916,11923,12066,12614,12761,12778,12974,13405,13516,13557,13748,14018,15607,15625,15821,16384,16804,16839,17052,17367,17987,18206,18813,18941,19042,19583,19929,20189,20246,20481,20941,21026,21056,21159,21550,23187,23559,24031,24357,24736,25044,25294,25365,25374,25480,25509,25547,25653,25764,25820,25833,25993,26584,26894,27975,27984,28156,28386,28387,28654,28721,29086,29089,29647,29993,30055,30272,30455,30738,31084,31183,31597,31876,31946,31963,32014,32246,32328,32488,32600,32837,33382,33701,35094,36375,38494,38750,38965,39012,39069,39200,39318,39333,39454,39561,39863,40053,40068,40214,40512,40899,40932,41174,41443,41520,41701,42113,42232,42410,42620,42910,43126,43279,43329,43511,44109,44203,44292,44444,44471,44990,45350,46042,46496,46602,46836,46892,47231,47637,47673,47833,47969,48249,48431,48504,48806,48845,49097,49252,49258,49341,49682,49841,22,259,446,526,662,762,996,1267,1560,2123,2393,2764,2863,3724,3759,4052,4066,4163,4556,5119,5144,5592,6311,7018,7428,7558,7690,8109,8549,8576,8726,8775,8945,9187,9243,9859,10723,10912,11026,11285,11828,11982,12448,12597,12878,13064,13247,13458,13703,13714,13793,14216,14503,15194,15385,15600,16236,16281,16561,16649,17144,17201,17809,17884,18299,18672,18891,19260,19797,19925,20078,20304,20532,21335,21474,21481,21544,22039,22164,22248,22707,22892,23323,23514,23829,24310,24779,24935,25090,25453,25659,26093,27135,27255,27309,27484,27670,28126,28535,28631,28776,29157,29295,29296,29561,29578,29953,30595,31138,31686,32071,32474,32542,32592,32890,32933,33301,34252,34343,34419,34760,34907,34916,35138,35221,35661,35929,36336,36441,37374,37443,37541,37742,37971,38372,38763,38937,39747,39892,40235,40829,41202,41372,42063,42066,42851,44275,44716,45032,45435,45589,45812,46343,46777,47491,48174,48547,48600,48638,48735,49229,49251,49349,49476,49574,49606,49721,82,149,248,881,1255,1435,1441,1565,1804,2258,2381,2708,2753,2761,2791,2899,3092,3568,3910,3943,4446,5007,5121,5292,5316,6253,6439,6445,6613,6618,6897,6941,7104,7126,7647,8293,8492,8965,9072,9719,9792,10101,10105,10890,11104,11239,11374,11387,11842,12158,12585,12965,13027,13127,13150,13160,13931,14210,14230,14479,14598,14723,14768,15066,15664,15735,15763,16078,16087,17056,17734,17906,18261,18280,18405,19191,19753,19930,20038,20382,21112,21265,21303,21463,21583,21723,21728,21887,22167,22361,22797,22932,23049,23419,24360,24449,24580,24609,24976,24995,25590,26360,26590,26910,27254,27353,27472,27531,27689,27989,28021,28257,28455,28494,28543,28799,29327,29413,29569,29846,29978,30390,30443,30988,31040,31239,31891,32252,32459,32543,33417,33640,34040,34532,34698,34720,35740,36063,36230,36654,36986,37166,37186,37219,37416,37798,38596,38893,39360,40115,40141,40174,40229,40316,40317,40376,40545,40686,40924,40994,41375,41521,42190,42929,43289,44383,44647,44754,45035,45334,45365,45414,45775,45863,45876,45959,46025,46389,46402,46427,46676,46926,47150,47202,47831,48565,48732,48922,48973,49267,49369,49497,49615,49831,49899,49964,16,50,614,916,951,1195,1686,2057,2257,2430,2526,2726,2727,2866,2978,3629,3795,4028,4437,4660,4735,4816,5450,6167,6578,6922,7723,8380,8391,8625,10131,10141,10399,11039,11299,11436,11535,12086,12115,12117,12306,12416,12514,12616,12771,13030,13293,13676,13994,14032,14197,14519,14965,15362,15790,15965,16002,16206,16320,16461,16623,16935,17404,17522,17589,17597,17800,17830,17838,17885,17944,18829,18908,20222,20305,20389,20482,20891,21627,21953,21963,22009,22108,22525,22668,22769,23571,23721,23845,23863,23971,24103,24929,25601,25785,25916,26026,26306,26353,26369,26703,26924,26939,27095,27416,27619,27693,27756,28024,28060,28199,29034,29244,29312,29487,29642,29800,29849,29999,30042,30617,30739,30993,32506,32746,32979,33133,33192,33540,33754,34020,35281,35430,35497,35667,35720,36380,36612,36943,37076,37234,37391,37580,38205,38287,38330,38454,39195,39529,39620,40116,40305,40510,40553,40587,40781,40830,40926,41859,42306,42382,42530,42745,42920,43486,43809,44223,44378,44588,44783,44941,44961,45258,46063,46103,46117,46229,46423,46450,47002,47255,47664,48628,48746,48899,48966,49496,49803,49965,142,387,495,531,684,1308,1743,1996,2131,2371,2488,2581,2591,2748,3075,3222,3234,4010,4155,4247,4695,5079,5590,5639,5964,6389,7533,8165,8338,8609,8998,9286,9446,10170,10332,10646,10829,11154,11353,11563,11600,11694,11972,12123,12190,12683,13049,13658,13797,14250,14294,14597,14599,14731,15034,15690,15911,15967,16068,16421,16532,16609,16688,16713,17088,17297,17632,17731,17864,17997,18412,18654,18729,18793,18797,18814,19131,19300,19371,19443,19630,19654,19764,19907,20086,20671,20886,20980,21542,21891,21960,22148,22244,22414,22435,22657,22674,22893,23247,23280,23548,23891,24079,24201,24373,25338,25890,25974,26027,26377,26437,26578,27754,27863,28250,28576,28919,29422,29575,29943,30097,30452,30571,30877,31255,31861,31898,32755,32876,32904,33652,34118,34768,34860,35051,35468,35482,36028,36072,36105,36277,36721,36783,36921,37048,37216,37566,37999,38552,38555,38612,39370,40192,40242,40495,40599,40723,41390,41746,41783,41891,41993,42015,42075,42241,42249,43172,43533,43884,43942,43948,43979,44738,44929,45112,45208,45233,45366,45756,45818,45912,46375,46979,47189,48170,48251,48283,48405,48660,48744,48858,49124,49297,49663,49983,93,468,524,1154,1209,1471,1508,1854,2347,2831,3496,3930,4051,4378,4395,4412,4450,4888,5082,5152,5223,5355,5453,5899,6122,6346,6846,6927,6996,7344,7648,8464,9407,10039,10123,10158,10836,11187,11385,11490,12058,13376,14160,14175,14343,14410,14420,14674,14945,15305,15435,15759,16317,17066,17164,17174,17355,17554,17765,17950,18129,18545,18734,19003,19049,19350,19489,19500,19758,19760,19882,20135,20205,20311,20470,20717,22157,22253,22558,22813,22819,23511,23812,23907,24458,24653,24784,25290,26317,26808,26818,26962,26990,26993,27362,27721,27969,28085,28382,28457,28476,28592,28868,28902,29612,29741,29972,30093,30195,30237,30310,30505,30611,30693,30961,31033,31224,32190,32491,32697,33085,33517,33726,33854,34229,34393,34533,34761,34830,35116,35220,35229,35320,35331,35441,35622,35801,35978,36526,36686,37226,37254,37343,37386,38000,38080,38120,38180,38353,38749,38878,39543,39880,40064,40127,40375,40455,40501,40502,41124,41720,42196,42264,42284,42479,42722,42737,43382,43579,44222,44833,44969,44977,45534,45535,45657,45700,45788,46036,46468,46474,46601,46678,47562,47846,48016,48477,48623,49154,49418,49673,49827,}
	s[4]=[]int{68,91,414,963,1624,1735,1905,1915,2361,2597,2763,2990,3067,3125,3286,3605,3707,4409,4470,4507,5311,5377,5444,5705,5963,6127,6557,6737,7052,7308,7634,8098,8400,8628,8988,9124,9143,9170,9380,9583,9764,9799,9809,9980,10191,10301,10416,10638,10742,10770,10951,11131,11210,11267,11478,11810,11838,12131,12360,12935,12993,13291,13380,13450,13648,13696,13728,14020,14133,14171,14704,14718,14746,14773,14882,14916,15017,15155,15541,15604,15635,16794,16886,17656,17952,18427,18436,18523,19139,19200,19273,20002,20256,20345,20605,20938,20945,22062,22777,22868,22986,23066,23111,23291,23349,23988,23992,24198,24226,24480,25040,25564,25609,26789,27345,27512,28123,28309,28591,28597,28739,28811,28933,28991,29065,29277,29407,29867,30025,30466,30478,30706,30817,30897,31259,31371,31650,31823,31869,32192,32665,32797,32923,32951,33212,33560,33692,33878,33951,33999,34076,34338,34472,34650,35626,35943,36509,36735,36890,36963,37017,37225,37276,37382,37444,37579,37672,37889,38089,39082,39250,39450,39477,39587,39750,39831,39975,40050,40110,40275,40709,41249,41277,41286,41432,41476,41874,41903,41906,41941,42251,43288,44037,44309,44713,44714,44926,45062,45089,45391,45691,45977,46021,46094,46188,46854,46934,47508,48372,48919,48920,48945,49030,49884,84,166,340,726,961,1052,1336,1514,1627,1856,1862,2007,2048,2064,2959,3178,3240,3595,3791,3988,4053,4092,4315,4394,4498,4955,4958,5029,5186,5489,5930,6009,6201,6365,7306,7705,7726,7789,8330,8587,8747,8822,8828,9091,9181,9877,9892,10010,10033,10517,10680,11004,11008,11012,11111,11163,11465,11582,12006,12008,12162,12392,12405,12595,12805,14770,15129,15197,15225,15300,15464,15935,15976,16098,16220,16339,16391,16605,16966,17027,17314,17412,17661,17737,17865,18198,18317,18325,18598,18878,18888,19041,19140,19244,19406,19903,19914,20339,20411,20460,20681,20787,20932,20988,21149,21240,21414,21628,21649,21657,21768,21781,21783,22457,22462,22616,22774,22783,23058,23137,23410,23835,24467,25205,26210,26384,26419,26661,26733,26819,27385,28022,28702,28731,29253,29599,29937,30269,30721,31154,31194,31790,31908,32060,32287,32322,32503,32814,33033,33528,33557,34200,34241,34302,34437,34465,34648,34898,34981,35026,35231,35434,35523,35532,35649,35859,36031,36189,36195,36196,36303,36401,36534,36678,36727,36856,37685,37777,37905,38221,38374,38528,39113,39136,39367,39369,39700,39756,39862,40245,40340,40615,40713,40743,40811,40891,41427,42349,43530,43560,43599,43640,43703,43969,44036,44144,44307,44882,44982,44999,45172,45211,45623,45845,45927,46020,46058,46079,46472,46499,46582,46921,47119,47364,47368,47381,47655,47794,48436,48710,48769,48929,49107,49146,49160,49260,49298,49603,49633,49664,49882,151,160,215,403,461,501,563,575,626,757,958,1551,2192,2534,2629,2981,3415,3449,3602,3820,3843,3973,4124,4333,4480,4508,4893,4993,5926,6061,6321,6348,6579,6629,6723,6822,7057,7247,7261,7282,7334,7434,7455,7856,8000,8100,8137,8568,8655,8811,8984,9114,9209,9423,9679,9981,10099,10166,10458,11212,11401,12002,12183,12471,12540,12618,12916,13364,13412,13570,13584,13936,13975,14333,14943,14954,15097,15136,15669,15684,15696,16403,16642,16950,17003,17215,17464,17639,18391,18617,18894,18975,19252,19801,19900,19924,20129,20524,20615,20632,20751,21032,21121,21941,22002,22031,22147,22223,22470,22823,23000,23741,23799,23965,24591,25041,25604,26070,26082,26489,26505,26738,26751,26886,27258,27852,27924,28709,28820,29547,29802,29997,30047,30513,30664,30681,31157,31229,31425,31459,31839,32063,32291,32310,32388,32411,32421,32484,32673,33141,33415,33619,33859,33971,34111,34205,34292,34342,34635,34651,34785,35321,35322,35669,35718,36127,36186,36269,36482,36697,36815,37623,37679,37717,37823,38030,38125,38144,38338,38954,39166,39452,39619,39643,39786,39922,40007,40205,40483,40676,40681,41083,41334,41671,42129,42228,42581,42638,42685,42726,42821,43229,43297,43352,43628,43639,43889,43895,44740,45425,45884,46164,46525,46918,47366,47391,47757,47941,48392,48632,48820,48883,49151,49314,49781,49848,406,842,921,1038,1265,1337,1432,1443,1833,2187,2193,2296,2604,2715,3059,3169,3377,3848,3997,4332,4550,4875,4934,5025,5226,5294,5387,5425,6081,6409,6573,6646,6650,7065,7333,7519,7693,7873,8155,8215,8692,8845,9347,9604,9825,9829,9868,10365,10776,10904,11019,11023,11151,11278,11415,11531,11686,11835,11976,12423,12680,13128,13214,13216,13525,13851,13918,13960,14243,14871,15261,15641,16081,16155,16369,16399,16429,16453,16499,16725,16781,16920,17114,17858,17870,17877,17931,17975,18130,18442,18780,19345,19383,19509,20331,20361,20424,20718,20857,21411,21811,22083,22217,22439,22591,22811,23055,23143,23310,23596,23709,24704,24986,25666,25722,25834,25990,26316,26471,26658,26811,27098,27167,27401,27574,27982,28084,28234,28599,28610,28623,28777,29208,29262,30084,30206,30257,30353,30694,30866,30947,31196,31807,32306,32452,32469,32507,32707,33159,33349,33548,33925,34214,34426,34917,35137,35437,35917,36411,36700,36837,37406,37990,38378,38479,38562,38910,38970,39245,39848,40194,40199,40273,40771,41256,42056,42069,42626,43609,43622,43646,43952,44606,45011,45034,45914,45944,46293,46380,46514,47155,47193,47556,47895,48126,48348,48596,49569,49590,49597,49855,95,167,243,334,352,1367,1447,1694,1782,2250,2259,2622,2812,2962,3203,4324,4672,4811,5204,5345,5348,5535,5560,5894,6881,7156,7329,7712,7906,8341,8379,8750,9012,9125,9940,9945,10349,10649,10950,11568,12000,12044,12364,12815,13219,13509,13513,13904,14080,14556,14645,14875,15266,15479,15587,15804,16382,16735,16761,17194,17964,17974,18086,18210,18514,18965,19173,19679,20013,20091,20158,20175,20530,20954,21064,21581,21875,21935,21943,22237,22448,22551,23177,23958,24124,24535,24977,25863,25896,26510,26586,26707,26724,26778,27200,27798,28064,28152,28290,28397,29833,29851,30407,30531,31171,31462,31749,31759,32170,32224,32407,32605,32882,33076,33276,33331,33503,33636,34404,34634,35069,35335,36050,36149,36350,36386,36848,37533,37674,37700,37712,37847,37911,37919,38109,38269,38672,38686,39006,39053,39455,39835,40200,40300,40533,40875,41020,41062,41431,41695,41793,41990,42147,42325,42424,42560,42605,42702,42986,43184,43409,43594,43693,44623,44641,45495,45550,45669,45793,46081,46454,46829,47275,47417,47855,48151,48569,48914,49680,194,606,1130,1221,1353,1584,1889,2058,2476,2695,2718,2877,3135,3153,3369,3510,3819,4308,4673,4862,4884,4918,5015,5095,5542,5905,5928,5998,6571,6797,6970,7222,7663,8005,8414,8503,8513,8906,8994,9340,9923,10441,10513,10802,10878,11105,11642,12355,12368,14325,15500,15962,15996,16938,17005,17193,17240,17286,17364,17469,18443,18869,18892,18973,19060,19177,19314,19603,19617,19983,20554,21072,21497,22071,22344,22571,22857,22918,23326,24425,24680,24885,25257,25324,25551,25747,26068,26598,26988,27068,27391,27534,27576,27870,28066,28283,28378,28424,28723,29776,30928,30931,30955,31004,31186,31426,31435,31628,32374,32792,32871,32945,32986,32988,33251,33532,33817,34018,34593,34610,34763,34839,34845,35875,35896,35901,35949,36975,37057,37647,37937,38114,38362,38487,38617,38710,40624,40693,40763,40870,42572,43688,44007,44239,44242,44603,44610,44955,44957,45047,45442,45606,46435,46537,46633,46863,46916,47613,47856,48105,48423,49443,49612,810,818,1326,1625,1656,2411,2441,2760,3408,4180,4216,4752,5035,5118,5146,5287,5545,6622,6709,8052,9482,9808,10226,10518,10633,10910,10929,11010,12611,12957,13122,13606,13845,13895,14127,14584,14601,14636,15567,15657,15809,16205,16343,16582,16672,17255,17415,17601,17646,17818,18016,18311,18335,18336,18700,18991,19363,20173,20468,20673,20765,21247,21933,22355,22573,22622,22952,23810,23826,23945,23948,24147,25786,25860,26221,26274,26599,26638,26704,27007,27390,27419,27615,27729,28755,28841,29053,29103,29750,30080,30313,30688,30836,30859,30915,31089,31116,31178,31565,31834,31883,32249,32502,32588,32607,32833,33034,33253,33830,34220,34349,34625,35841,36403,36649,37024,37110,37137,37185,37247,37880,38018,38402,38428,38429,39320,39372,39448,39953,40371,40374,40617,40776,41353,41498,41691,42715,42725,42741,42858,42892,43085,43656,43735,43878,44080,44442,45028,45344,45409,46757,48382,49389,49504,49725,26,74,271,486,1387,1552,2280,2375,2527,2972,3224,3358,3666,3994,4238,4642,4873,4910,5197,5212,5313,5340,5399,5501,5640,6381,7013,7626,7796,8430,8697,8886,9048,9852,10193,10437,11695,11830,12097,12251,12279,12477,12572,12768,12861,13408,13721,13743,13951,14539,14694,15475,15551,15984,16105,17176,17251,17271,17379,17385,17456,18559,19117,19176,20132,20503,20547,20641,20810,20813,20842,20851,20966,21250,21409,21918,22199,22599,22687,23112,23131,23174,25763,26094,26228,26492,26503,26958,27126,27152,27423,27465,27622,27939,28237,28323,28422,28730,28747,28986,29209,29307,29522,29529,29653,30386,30671,31211,31716,31984,32643,32907,33460,33634,33682,33710,33831,34187,34204,34355,34671,34717,35088,35324,35398,35592,35914,36039,36121,37649,37744,38194,38581,39031,39050,39718,39804,39853,39968,40244,40326,40473,40782,40963,41553,42280,42830,42861,42955,43193,43265,43472,43557,43908,44279,44739,44866,44963,44996,45311,45317,46059,46192,46251,46684,46743,47348,47419,47503,47570,47650,47783,48871,48925,49463,49493,49576,49728,49794,49996,420,438,904,1095,1517,1648,1771,2136,2465,2598,2653,2702,2855,2922,3041,5100,5902,6119,6353,6448,6538,6597,6663,6831,7021,7264,7357,7623,8127,8142,8565,8887,9293,9669,9997,10104,10220,10425,10430,11596,11736,12703,12750,13151,13220,13333,13583,13655,14188,14713,15126,15293,16114,16333,16410,16414,16814,17124,17424,17652,17982,18007,18189,18331,18830,19161,19568,20009,20052,20258,20387,20407,20500,20783,21355,21568,21989,22080,22307,22442,22486,22841,22935,23171,23223,23987,24272,24544,24603,24834,25219,25462,25541,25759,25824,26134,26139,26329,26872,27051,27612,28056,29270,29473,29769,30057,30110,30183,30336,30620,30695,30885,31445,31453,31553,31734,31786,31810,31967,33163,33169,34166,34487,34515,34528,34902,35388,35432,35501,35665,35683,36613,36768,37120,37189,37295,37302,37706,38107,38568,38903,39014,39048,40351,40575,40753,41705,41751,41828,42126,42177,42224,42657,42785,42825,42852,43119,43866,44003,44456,44526,44531,44629,45375,45666,47407,47487,48398,48443,48543,48711,48941,49788,66,110,434,518,722,841,2151,2445,2550,2965,3196,3477,3489,3927,4204,4616,4741,4857,4967,5891,6120,6785,6964,7263,7453,7837,8567,9239,9324,9908,10300,10704,11173,11306,11405,11675,11781,12834,13250,13444,13476,13799,14412,14752,15096,15185,15233,15315,15401,15465,15473,15595,15755,15951,16071,16192,16292,16565,16788,17006,17325,18986,19136,19407,20017,21167,21709,22040,22091,22142,22266,22747,22844,22876,23601,23839,23946,24067,24484,24764,24802,25350,25683,26109,26582,26966,27202,27242,28260,28847,30743,30963,31966,32143,32220,32229,32567,32658,33751,33989,34122,34586,35133,35453,35464,35737,35935,35999,36082,36329,38135,38350,38486,38678,38722,38727,39075,39235,39404,39491,39639,39983,40403,40744,40849,40961,41026,41252,41602,42434,42814,43278,43536,43716,43729,44081,44682,45155,45248,45281,45346,45446,46414,46561,46801,47319,48077,48550,48594,48604,48796,49352,49533,49539,49575,49773,787,853,999,1159,1228,1474,2024,3297,3410,3440,3638,3650,4118,4520,4966,5449,6108,6170,7181,8566,8744,8767,9070,9207,9264,9278,9646,10036,10074,10098,10115,10445,10484,10842,11356,11379,11534,12147,12308,12570,12760,12938,13251,13407,13598,13620,13693,13852,15107,15308,15440,15961,16138,16282,17002,17153,17470,18094,18197,18815,19078,19524,20349,20566,21071,21098,21381,22226,23286,23553,24153,24504,24529,24660,24683,24829,25128,25201,25246,25505,25620,26417,27239,27509,28074,28337,28446,28701,29298,29462,29635,29723,29896,30566,30896,31192,31506,32241,32757,33475,33694,33839,33857,33915,34088,34746,34862,35044,35080,35155,35204,35463,35699,37058,37109,37292,37369,37757,37842,37861,38132,38140,38281,38976,39060,39139,39627,39675,39716,40096,40674,40866,41419,41686,42373,42397,42457,43375,43416,44283,45119,45808,46168,46261,47209,47432,47536,47882,48049,48535,49104,49559,49768,49806,49941,102,377,500,559,679,1390,2341,2511,2698,2768,3544,3894,3961,4211,4874,5044,5755,5924,6036,6433,7221,7224,7250,7494,7854,8771,9006,9026,9428,10043,10056,10130,10297,12119,12176,12439,12704,12941,13161,13599,13642,13937,14109,14155,14588,14791,15035,15193,15743,16039,16133,16302,16673,17106,17585,18105,19081,19302,19317,19446,20089,20215,20768,20908,21044,21591,22692,23380,23611,24250,24703,25142,25190,25618,26288,26426,26628,27143,27431,27605,27820,27881,27944,28079,28147,28191,28313,28316,28461,28552,28700,29571,29948,29966,29970,30121,30235,30750,31180,31279,31364,31417,31466,31694,32694,32768,32777,33384,33452,33853,33934,34208,34300,34988,35048,35198,35680,35834,35858,36066,36138,36264,36500,36952,37396,38088,38111,38200,38325,38446,38584,38991,39108,39117,39395,39693,39988,40581,40787,40872,41477,42571,42950,42992,43222,43647,43903,44052,44066,44067,44266,44410,44901,45115,45813,46744,46749,47523,47628,47918,48241,48288,48961,49706,659,1175,2200,2232,2662,2716,2891,2955,3246,3713,3948,4263,4339,4341,4436,4468,4488,5727,5733,6155,6506,6533,6717,6965,7358,7481,7552,7600,8176,8340,8538,8783,8874,9068,9204,9280,9312,10086,10271,10507,10942,11001,11393,11693,12154,12268,13089,13504,13872,14015,14068,14238,14261,14381,14478,14818,15137,15178,15900,16383,16601,16720,16807,16894,17265,17338,17407,17827,17872,17961,18313,18390,18653,18971,19151,19954,20143,20875,20935,21131,21151,21229,21500,21587,21870,22141,23250,23339,23506,23977,24759,25391,25580,25644,25976,26122,26374,26706,26734,27346,27691,27722,27749,28706,29280,29428,29463,29815,30152,30365,30943,31220,32002,32221,33228,33545,33647,34256,34295,34603,34639,34821,34903,34969,35007,35055,35750,35763,35823,36502,36615,37070,37376,37923,38179,38306,38570,38805,39703,39763,40353,40719,40739,41081,41238,41248,41845,42210,42579,42763,42885,42984,43732,43817,43874,45995,46621,46875,47019,47408,47490,47940,48282,48352,48677,48815,49360,49522,49529,49585,437,1207,1426,1540,1873,1940,2053,2301,2414,3030,3271,3315,3380,3869,3932,5178,5781,6261,6431,6765,6875,6924,7063,7606,8164,8186,8214,9358,9449,10341,10515,10869,11126,11491,12332,12342,12383,12536,12999,13336,13398,13590,13732,14136,14451,14534,14757,15108,15237,15403,15621,15649,15863,16248,16684,16694,16806,17046,17172,17423,17636,17789,17845,18020,18309,18429,18608,18726,18799,18848,19124,20519,20887,21051,21646,21684,21688,21774,21938,22012,22264,22703,22826,23407,23545,23563,23657,23913,24214,24475,24496,24623,25595,26755,27138,27294,27894,28221,28408,29071,29211,29284,29829,30019,30126,30530,31222,31744,32692,32888,32955,32970,33010,33029,33426,33744,34304,34392,35166,35803,36170,36193,36243,37199,37223,37363,37384,37587,37711,38024,38301,38845,38972,38973,39149,39345,39871,39974,40808,41451,41687,41800,41893,42274,42576,42709,42850,42890,42898,43373,43876,44362,44389,44550,45072,45400,46287,46612,46817,46910,46953,47086,47259,47743,47778,48007,48217,48264,48285,48318,100,469,1120,1192,1463,1662,1754,3418,3564,3823,4245,4765,4972,5158,5461,5486,6013,6043,6482,6611,6775,6862,7661,8118,8169,8384,8847,9359,9966,10053,10059,10246,10320,10545,10850,11455,11633,12781,13449,13723,13813,14263,14702,14893,15247,15359,15418,15847,15869,15891,16037,16250,17468,17507,18605,18697,19299,19341,19556,19659,19936,21266,21301,21771,21993,22329,23005,23590,24225,24352,25810,25998,26367,27810,28228,28481,29372,29541,30196,30318,30609,31514,31816,32230,32458,32717,32805,32878,32950,33662,34307,34735,35310,35624,35717,35799,36197,36297,36842,37465,38121,38355,38524,38607,39086,39923,40308,40350,40710,41474,41806,42156,42441,42637,42660,43240,43554,44395,44616,44655,45686,45737,46523,46677,47096,47099,47305,47457,47470,48195,48520,48581,49031,49488,49678,}
	s[5]=[]int{475,530,536,845,1065,2019,2111,2276,3148,3243,4393,5165,5494,5772,6554,7292,7296,7499,7630,7635,8168,8198,8976,9386,9486,9609,9904,11674,11845,12152,12533,12712,12791,13254,13392,13434,13762,13954,14075,14087,14108,14734,14814,14827,15466,15938,16740,16944,17928,18068,18838,19246,19820,19940,20309,20330,21084,21088,21168,21507,21533,22845,22914,24230,24297,24332,24889,24985,25328,25755,25960,26168,26497,26775,27499,27541,27556,27572,28070,31441,31585,32475,33119,33470,33683,33994,34042,34104,34158,34281,35982,36131,36497,38139,38415,38748,39115,39229,39398,39416,39676,39960,40100,40520,41005,41029,41059,41702,42002,42351,42923,42975,43501,43765,44652,46410,47071,47328,47340,47730,48039,48146,48224,48592,48706,48800,48996,49042,49401,49897,49998,337,600,763,1422,1597,1653,1711,1802,1878,1953,2218,2253,2847,3211,3406,3547,3757,3847,4064,4154,4160,4387,4592,4719,4799,5028,5156,5278,5858,6142,6331,6720,6767,6899,6902,7053,7238,7326,7386,7818,8525,8610,9071,9383,9414,9681,9891,10265,10438,10466,10491,10563,10588,10717,11005,11042,11140,11315,11722,11849,12554,12664,13562,14661,15198,15228,15236,15433,15904,16003,16467,16653,17014,17049,17065,17443,17492,17569,17683,17876,18100,18389,18486,18778,19236,19263,19271,19794,19933,20517,20677,21016,21259,21291,21439,21764,21836,22075,22369,22606,22778,22802,22939,22951,23138,23204,23342,23346,23425,23836,24120,24138,24286,24733,24833,25208,25492,25873,25997,26771,26802,26901,26970,27078,27238,28369,28402,28736,28784,29510,29783,30470,30550,30966,31041,31107,31181,31406,31718,32870,33040,33145,33259,33904,34334,34525,34753,34774,34947,35060,35188,35678,35768,35780,35833,35939,35968,36490,36853,37346,37415,37542,38228,38451,38520,38561,38618,39712,39729,39963,40014,40318,40748,40758,41525,41767,42090,42687,42721,43676,44017,44142,44508,44546,44673,44703,44936,45053,45337,45381,45524,45622,45733,45854,45918,46244,46347,47012,47434,47515,47551,47596,47604,47989,48338,48388,48620,48976,49177,49227,49428,49987,76,163,168,543,918,1058,1205,1215,1450,1538,1852,1918,2205,2265,2384,2984,3478,3581,3588,3736,3829,3860,4346,4755,4903,5010,5352,5760,5845,5993,6872,7607,7888,8132,8241,8287,8484,8613,8616,8668,8881,9218,9415,9617,9741,9756,9853,10448,10485,10488,10946,10973,11128,11202,12219,12389,12495,12746,12897,12905,13046,13217,13243,13294,13475,13715,13811,14181,14194,14293,14476,14623,14924,14934,15080,15853,15888,16054,16152,16419,16762,17455,17557,17938,17967,18017,18159,18204,18330,18534,19723,20024,20318,20338,20378,20445,21077,21249,21296,21686,22020,22066,22272,22341,23053,23196,23409,23430,24348,24742,24820,24950,25107,25649,25841,25949,26098,27158,27458,27504,28061,28555,28679,28927,28973,29130,29360,29765,29865,30589,30612,30641,31219,32145,32545,33386,33984,34080,34479,34701,34738,34788,34819,34905,35315,35487,35706,35863,36111,36114,36581,36684,36719,36795,37249,37405,37433,37784,37850,37978,37991,38031,38104,38239,39061,39066,39227,39606,40833,40992,41111,41130,41306,41814,42004,42079,42329,42341,42979,43327,43332,43412,43747,44008,44413,45000,45015,45216,45286,45553,45925,46085,46511,46638,47108,47308,47516,47553,48295,48812,49004,49381,49759,49804,49936,153,384,675,1027,1377,2447,2559,3306,3467,3712,4091,4147,4858,4891,4935,5207,5231,5740,6134,6316,6432,6550,6694,7230,7290,7389,7858,8295,8406,8407,8629,8785,8937,9065,9118,9136,9199,9563,9826,10084,10264,10660,10777,11015,11971,12192,12209,12357,12426,12972,13136,13885,13998,14275,14785,15344,15484,15524,16097,17155,17471,17550,17638,17891,18236,18544,18743,19020,19068,19073,19240,19919,20693,20723,20922,20924,21231,21338,21351,21510,21741,21786,22153,22186,22714,22729,22968,23010,23162,23209,23294,24549,24854,24882,24967,25007,25913,25952,26087,26209,26541,26994,27307,27826,27907,28101,28440,28697,29080,29171,29621,29759,30081,30345,30584,30615,31085,31270,31437,31938,32016,32235,32471,32558,32763,32884,33024,33396,33760,33784,34147,34312,34365,34672,34842,34913,36327,36491,36582,36718,36905,36969,37201,37857,38037,38048,38460,38531,38756,38884,39207,39796,40016,40198,40522,40648,40765,40806,41456,41543,41641,42430,42925,42982,43118,43490,43566,44311,44401,44403,45574,45969,46217,46563,46659,46998,47205,47441,47521,47909,48080,48135,48422,48646,48915,198,308,1106,1151,1368,1585,1700,1737,1798,1925,2036,2183,2240,3122,3494,3887,4016,4225,4248,4463,5319,5591,5782,5829,6019,6704,6746,6954,8036,8349,8862,8936,8993,9716,10669,11467,11888,11958,12208,12907,13917,14066,14158,14375,14706,15167,15191,15292,15311,15325,15727,15879,16956,17493,17629,17888,18271,18792,19048,19706,20160,20192,20606,20623,20939,22011,22044,22389,22453,22463,22530,22579,22874,22963,24841,24941,25893,25978,26025,26052,26318,26514,26678,27049,27080,27149,27329,27394,27657,27816,27842,28449,28516,28808,29057,29100,29198,29220,29485,29690,30172,30554,30949,31316,31499,31618,31647,32216,32360,32557,32602,32794,33257,34266,34273,34851,34901,34952,35267,35514,35734,35922,35947,36212,36316,36471,36501,36982,36994,37277,37348,37497,37605,37657,37935,38308,38651,38709,38889,38907,39090,39267,39565,39599,40135,40597,40797,40890,40979,41108,41350,41816,41867,42449,42691,42829,43090,43235,43258,43299,43505,43670,43905,44583,44838,45041,45878,46471,46894,46896,47017,47286,47430,47679,47766,48343,48771,48781,49566,49853,86,286,748,1170,1190,1223,1358,1913,2115,2156,2681,2712,2938,3299,3591,4099,4244,4306,4362,5014,5270,5566,5897,5957,6510,6588,6813,7031,7732,7847,8382,8969,9192,10233,10289,10544,11168,11509,11723,12578,12690,13042,13269,13386,13524,14240,14590,14600,15216,15654,16055,16134,16301,16543,16663,17221,17409,17502,17911,18489,18507,18625,18932,19006,19427,19521,19677,19848,20235,20435,20621,21194,21273,21713,21744,21788,21932,22538,23059,23109,23504,23536,23599,23693,23877,24043,24091,24436,24734,24886,25075,25588,26051,26129,26446,26848,27424,28093,28104,28653,28875,29144,29508,30129,30151,30363,30496,31218,31232,31402,31659,31778,31826,31877,32062,32277,32368,32649,33302,33425,33510,33620,34296,34491,34710,35145,35224,35668,36013,36286,36690,37561,37640,37729,37805,37915,38003,38390,38809,39096,39205,39341,39458,39966,39999,40515,40851,41092,41339,41388,42202,43160,43914,44345,44731,45109,45569,45964,46091,46277,47027,47039,47143,47241,47513,47913,48035,48083,48214,49219,49383,49984,321,362,899,944,1884,2871,2876,2940,3071,3279,3425,4251,4322,4554,4589,5112,5385,5554,5666,5684,5962,6032,6169,6497,6940,7581,8392,8445,8466,9058,9224,9586,9612,9972,10136,10385,11038,11086,11092,11103,11286,11970,12064,12139,12241,12361,12876,12940,13152,13192,13603,13741,14542,14729,14747,14975,14976,16074,16340,17537,18629,18631,18812,19560,20250,20385,20458,20871,21238,21987,22069,22085,22201,22300,22323,22601,22632,23029,23236,23422,23609,23858,24538,24672,24817,24868,24965,25150,25213,25351,25936,26451,27367,27400,27719,27879,28498,28502,28559,29535,29697,30135,30321,30676,30760,32440,32728,33150,33219,33243,33451,33474,34210,34962,35022,35390,35583,35759,36395,36489,36817,37040,37041,37196,37536,38662,38743,39350,39614,39624,39962,40144,40288,40494,40703,40826,41158,41237,41591,41857,42012,42134,42607,42930,42942,43078,43081,43358,43697,44070,44116,44721,45023,45197,45279,45379,45796,45867,46479,48552,48666,49311,49500,49940,184,1033,2287,2418,2491,2634,2892,3266,3378,3454,4414,4743,4879,5615,6017,6158,6401,6764,6829,7055,7061,7143,8129,8435,8980,9049,9117,9137,9186,9272,9422,9532,9614,10915,11072,11133,11348,11381,11709,11912,12096,12213,12508,12621,13343,13352,13487,13704,14306,14958,15428,15732,16143,16183,16947,17116,17596,17606,18160,18205,18667,18796,19030,19839,19952,20438,20649,20653,21252,21352,21361,21517,22019,22636,23184,23460,23725,24044,24109,24582,25297,25356,25512,25802,26870,27637,27834,27950,28364,28509,28698,29137,29564,30238,30552,31320,31655,31806,32268,32952,33063,33442,33543,34132,34161,34236,34317,34624,34945,35380,35511,35847,36998,37077,37175,37356,37611,38898,39056,39297,39980,40042,40108,40366,40698,40756,41810,41968,42059,42503,43076,43117,43281,44339,44454,45026,45644,46823,48154,48320,48866,49015,49192,49334,49343,49762,49840,49945,20,231,759,1079,1273,1509,1675,1848,2073,2198,2421,2680,2806,3441,3473,3476,3660,3770,4243,5059,5245,5510,6136,6380,7598,7610,7646,7916,7926,7964,8182,8589,9231,9366,9798,10581,10655,10864,10882,11254,11592,11956,12165,12178,12856,13324,14135,14406,14419,14666,14844,15177,15388,15573,15624,15921,15942,16032,16123,16348,17091,17694,18142,18310,18881,18909,19285,19519,19908,20298,20501,20743,21122,21255,21325,21856,21863,22673,23625,24539,24721,24765,24874,25343,25399,25781,26230,26372,26488,26852,26951,27955,28259,28415,29345,29826,30024,30075,30176,30600,31460,31889,32117,32270,33094,33500,33611,33668,33761,33796,33935,34056,34171,34184,34217,34308,34424,34843,34844,34965,35098,35233,35549,36182,37198,37327,37524,38007,38274,38433,39018,39191,39389,39767,39899,40190,40822,41137,41178,41292,41461,41551,42661,42723,42729,42761,42939,42954,43099,43309,43519,43891,43989,44130,44371,45415,46374,46431,46491,46568,46573,46784,48197,48541,48752,49815,529,683,804,1233,1466,1724,1897,2146,2449,3026,3053,3227,3365,3383,3616,3749,4197,4205,4215,4241,5517,5881,5942,6179,6744,7323,7549,7797,7826,7843,7987,8243,8531,8975,9202,9458,9755,9893,10281,11232,11275,11451,11637,11744,11915,12267,12277,13698,13920,14004,14166,14952,15286,15520,15620,16219,16328,16378,16493,16689,17045,17163,17295,19186,19564,19615,19810,20048,20146,21113,21396,21421,22103,22224,22658,23212,23377,23441,23905,24050,24224,24278,24448,25678,26266,26315,27228,28188,28903,29072,29308,29324,29445,30503,30599,30692,30805,31296,31772,31900,32158,33110,33180,33288,34138,34206,34332,34598,34637,35558,36614,36918,37379,37381,37514,37772,37825,38077,38796,38997,39274,39445,39487,39956,40405,40914,40951,41004,41340,42555,42569,42987,42991,43166,44022,44183,44327,44459,44741,45754,45898,45954,46019,46035,46151,46158,47378,47514,48048,48060,48507,48679,49,113,823,1825,1995,2067,3045,3644,3857,4009,4320,4662,5116,5265,5447,5571,6057,6139,6429,6540,6590,7118,7463,7758,7939,8262,8335,8408,8555,8719,8940,9194,9390,9673,9704,10067,10235,10273,11229,11453,11517,11622,11963,12829,13510,13801,13949,13976,14354,14758,14899,15026,15659,15766,15832,16244,16425,16668,16773,16825,17514,17690,17767,17936,18701,19283,19667,19698,19866,20162,20224,21986,22235,22243,22607,23164,23188,23384,23815,24229,24719,25360,25650,25987,26005,26089,26330,26386,26626,26726,26754,26800,26960,27215,27456,27616,28175,28864,28934,29040,29568,29742,30792,30821,31113,31489,31501,31516,31920,31933,32033,33258,33526,33538,33630,33722,33806,34055,34167,34743,35058,35490,35512,35609,35952,36108,36152,36171,37485,37770,37783,37925,38159,38242,38341,38924,38931,38982,39486,39629,39677,39973,40289,40595,40660,40840,40989,41276,41506,41663,41911,41930,41996,42088,42097,42386,42838,43002,43323,43434,43567,43738,43796,43821,44113,44272,44372,44762,44932,45038,45272,45558,46069,47135,47310,48554,48797,48861,49735,31,52,98,347,733,848,1124,1615,2817,2826,3485,3606,3771,3828,4184,4714,6803,7811,8023,8063,8069,8246,9579,9781,9947,10239,10774,10806,11113,12204,12275,12831,12898,13318,13411,13466,13709,14050,14129,14568,14863,14877,15128,15451,15640,16354,16530,16690,17072,17304,17405,17551,17721,18155,18852,18870,19280,20063,20848,20894,21392,21794,22256,22698,22979,23130,23161,23600,23678,23851,25073,25458,25699,25901,26447,26529,26575,26979,27105,27569,27892,28331,28353,28545,28633,29177,29344,29787,30069,30230,30709,31187,31652,31679,31736,31888,32369,32663,32816,32992,33654,33786,33810,33822,34035,34064,34612,34790,35241,35498,36237,36739,36874,37043,37168,37760,38283,38681,38882,38958,39239,39782,40019,40450,40471,40696,40862,41078,42211,43385,44343,44756,45170,45428,45584,46637,46793,46834,47896,48117,48439,48993,49171,538,1739,2072,2383,2419,2607,2613,3027,3442,3993,5018,5221,5796,6561,7256,7415,7853,8014,8511,8854,9246,9393,9516,9700,9867,9978,10223,11208,11214,11325,11719,11910,11935,12101,12601,12795,14083,14389,14390,14547,14781,14921,15099,15188,15546,16466,16667,16724,17373,17828,18167,18359,18483,18710,19077,19574,19689,20715,20864,21248,21707,22889,23075,23622,23706,24568,24752,24790,25316,25329,25767,26020,26231,27312,27483,27869,28238,28793,28889,28892,29221,29577,30965,31014,31245,31995,32045,33065,33198,33202,33660,34870,35778,35953,36185,36220,36549,36830,37129,38649,39177,39218,39410,39558,40251,40479,40507,40974,41325,41799,42000,42060,42263,42610,43654,43708,43939,44031,44782,44916,44993,45298,45827,45903,46546,47220,47717,48301,48616,48798,49028,49095,49243,49932,124,542,836,1280,1706,1844,2213,2309,2593,2720,3173,3216,3493,5225,5475,6053,6090,6144,6488,7010,7151,7311,8146,9595,9651,10492,10572,10856,10935,11050,11429,11520,11827,12600,12676,13107,13322,13876,13921,14002,15374,15453,15768,16407,16834,17029,17391,17615,17879,18245,18646,19174,19668,20454,21090,21375,22138,22659,22773,22983,23268,23315,23465,23938,24063,24432,24869,24873,25042,25431,25474,26790,26861,26917,27046,27392,27544,27759,27768,28255,29036,29120,29456,29808,29820,31002,31338,31612,31695,31853,32064,32104,32866,33260,33330,33521,33860,34341,34800,34801,35711,35782,36021,36496,36537,36791,36966,37874,38361,39008,39099,39169,39282,39523,39667,39834,39893,40024,40211,40468,40555,41335,41479,41858,42055,42316,42493,42707,43071,44060,44342,45280,45390,45547,45707,45891,46082,46111,47018,47117,47206,47395,47880,48009,48432,48854,48876,49022,49189,49480,49521,49571,49703,49802,371,573,1179,1349,1393,1449,1550,1827,3636,3946,4024,4239,5136,5819,6099,6172,7050,7337,8159,8163,8907,9032,10457,10970,11474,11494,11576,11800,11844,12335,12992,13600,13751,14119,14823,14963,15666,15975,16462,16811,17143,17337,17350,17511,17686,17711,17790,17804,18226,18329,19222,19286,19319,19328,19883,20502,20562,20637,20804,20830,20866,21775,21779,21920,22252,22261,23279,24996,25332,25636,25733,26050,26580,27104,27165,27279,27632,27778,27783,28279,28715,28827,29627,30015,30060,30137,30317,30376,30768,31117,31543,31700,32251,32754,32972,33008,33209,33273,33581,33648,34126,34191,34781,34820,34865,35062,35405,35572,35657,35708,35802,36010,36217,36764,36825,37477,37601,37676,38564,38953,38988,40146,40683,41483,41987,42093,42124,42353,42420,42427,42451,42616,42636,42733,42818,43287,43764,44507,44835,45240,45694,46031,46576,47316,47678,47708,48101,48788,48886,49180,49300,49957,}
	
	list := s[steps]
	
	list_position_end:=list_position+1000
	if list_position_end > len(list) {
		list_position_end = len(list)
	}
	
	problem_list := list[list_position:list_position_end]
	
	solve_list_of_problems_and_write_to_db(steps, problem_list, false)
}

func solve_list_of_problems_and_write_to_db(steps int, problem_list []int, is_training bool) {  
	var kaggle LifeProblemSet
	
	kaggle.load_csv(is_training, problem_list)

	// Now ensure that the transition_collection is valid for this step size
	kaggle.load_transition_collection(steps)
	
	queue := make(chan *Work)

	n_problems := len(problem_list)

	ncpu := runtime.NumCPU()
	if n_problems < ncpu {
		ncpu = n_problems
	}
	runtime.GOMAXPROCS(ncpu)

	// spawn workers
	for i := 0; i < ncpu; i++ {
		go problem_worker_for_queue(i, queue)
	}


	start_time := time.Now()
	// master: give work
	for i, id := range problem_list {
		if kaggle.problem[id].steps != steps {
			fmt.Printf("Need to match problem[%d].steps=%d (not %d)\n", id, kaggle.problem[id].steps, steps)
		}
		wp := Work{
			id:id, 
			i:i, n:n_problems,
			is_training:is_training,
			steps:steps, 
			lps:&kaggle,
			number_of_times_to_run_this_id:2,  // TODO : CHANGE THIS BACK TO 1 !!
		}
		
		now_time := time.Now()
		eta := "Unknown"
		rate_per_1000 := 0
		
		completed_units := (i-ncpu) // We launched ncpu 'for free', so only have completed the reduced #
		if completed_units>0 {
			total_duration := now_time.Sub(start_time)
			
			eta_duration := time.Duration(n_problems * int(total_duration)/ completed_units)
			eta_time := start_time.Add(eta_duration)
			eta = eta_time.Format("2-Jan-2006 @ 3:04pm")
			
			rate_per_1000 = int(eta_duration) * 1000 / n_problems / 1000 / 1000 / 1000 // Convert nano-seconds to seconds
		}
		
		fmt.Printf("master   : hand out work :: %5d -- %5d/%5d ETA: %s  Rate=%2dm/1000 (delta=%d)\n", id, i, n_problems, eta, rate_per_1000/60, steps)
		queue <- &wp
	}

	// all work is done
	// push ncpu*nil on the queue so that each worker will receive signal that there is no more work
	for n := 0; n < ncpu; n++ {
		queue <- nil
	}
}

